# üîÑ –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π (–ì–∏–±—Ä–∏–¥–Ω—ã–π) –ü–æ–¥—Ö–æ–¥ - –ü–æ–¥—Ä–æ–±–Ω–æ–µ –û–±—ä—è—Å–Ω–µ–Ω–∏–µ

## üéØ –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

**–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥** = **PDF —á–µ—Ä–µ–∑ API** + **HTML –ø–∞—Ä—Å–∏–Ω–≥** –≤ –æ–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ

–í–º–µ—Å—Ç–æ –≤—ã–±–æ—Ä–∞ –æ–¥–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞, —Å–∏—Å—Ç–µ–º–∞ **–ø—Ä–æ–±—É–µ—Ç –æ–±–∞** –∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!

---

## üìã –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã:

```
1. –ü–†–û–ë–£–ï–ú PDF —á–µ—Ä–µ–∑ API (–±—ã—Å—Ç—Ä–æ)
   ‚îú‚îÄ –ï—Å–ª–∏ PDF –±–æ–ª—å—à–æ–π –∏ –ø–æ–ª–Ω—ã–π ‚Üí ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
   ‚îî‚îÄ –ï—Å–ª–∏ PDF –º–∞–ª–µ–Ω—å–∫–∏–π (–∑–∞–≥–ª—É—à–∫–∞) ‚Üí ‚¨áÔ∏è

2. –ü–ê–†–°–ò–ú HTML (–Ω–∞–¥–µ–∂–Ω–æ)
   ‚îú‚îÄ –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç
   ‚îú‚îÄ –û—á–∏—â–∞–µ–º –æ—Ç —Å–ª—É–∂–µ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
   ‚îî‚îÄ –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ TXT

3. –†–ï–ó–£–õ–¨–¢–ê–¢
   ‚îî‚îÄ –í—ã–±–∏—Ä–∞–µ–º –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç (PDF –∏–ª–∏ TXT)
```

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### 1. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**
- –ï—Å–ª–∏ PDF —á–µ—Ä–µ–∑ API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí HTML –ø–∞—Ä—Å–∏–Ω–≥ —Å–ø–∞—Å–µ—Ç
- –ï—Å–ª–∏ HTML –ø–∞—Ä—Å–∏–Ω–≥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí PDF —á–µ—Ä–µ–∑ API –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å
- **–î–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞!**

### 2. **–°–∫–æ—Ä–æ—Å—Ç—å**
- –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –±—ã—Å—Ç—Ä—ã–π –º–µ—Ç–æ–¥ (PDF —á–µ—Ä–µ–∑ API)
- –ï—Å–ª–∏ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç - –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ (–Ω–µ –Ω—É–∂–Ω–æ –ø–∞—Ä—Å–∏—Ç—å HTML)
- **–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏!**

### 3. **–ö–∞—á–µ—Å—Ç–≤–æ**
- PDF —á–µ—Ä–µ–∑ API - –∏–¥–µ–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π PDF)
- HTML –ø–∞—Ä—Å–∏–Ω–≥ - –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç (–µ—Å–ª–∏ PDF –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)
- **–í—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ–º —á—Ç–æ-—Ç–æ!**

### 4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä**
- –°–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ —Ä–µ—à–∞–µ—Ç, –∫–∞–∫–æ–π –º–µ—Ç–æ–¥ –ª—É—á—à–µ
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü
- **–£–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞!**

---

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å

### –®–ê–ì 1: –ü–æ–ø—ã—Ç–∫–∞ PDF —á–µ—Ä–µ–∑ API

```python
# –ï—Å–ª–∏ –µ—Å—Ç—å eo_number
if eo_number:
    # –ü—ã—Ç–∞–µ–º—Å—è —Å–∫–∞—á–∞—Ç—å PDF
    pdf = download_pdf_via_api(eo_number)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä
    if pdf.size > 500 –ö–ë and pdf.pages > 50:
        # ‚úÖ –≠—Ç–æ –ø–æ–ª–Ω—ã–π –∫–æ–¥–µ–∫—Å!
        return pdf
    else:
        # ‚ö†Ô∏è –≠—Ç–æ –∑–∞–≥–ª—É—à–∫–∞, –ø—Ä–æ–±—É–µ–º HTML
        continue
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**
- –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å > 500 –ö–ë)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å > 50)
- –ï—Å–ª–∏ –æ–±–∞ —É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º PDF

### –®–ê–ì 2: –ü–∞—Ä—Å–∏–Ω–≥ HTML

```python
# –ï—Å–ª–∏ PDF –Ω–µ –ø–æ–¥–æ—à–µ–ª –∏–ª–∏ –Ω–µ –±—ã–ª–æ eo_number
html_text = parse_html_codex(html_url)

# –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–µ–∫—Å—Ç
# - –£–±–∏—Ä–∞–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é
# - –£–±–∏—Ä–∞–µ–º —Å–ª—É–∂–µ–±–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
# - –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç –∫–æ–¥–µ–∫—Å–∞

if html_text.length > 10000 —Å–∏–º–≤–æ–ª–æ–≤:
    # ‚úÖ –ü–æ–ª—É—á–∏–ª–∏ –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç!
    return html_text
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è:**
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —á–µ—Ä–µ–∑ Selenium
- –ñ–¥–µ—Ç—Å—è –ø–æ–ª–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ JavaScript
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è —Ç–µ–∫—Å—Ç –∏–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –û—á–∏—â–∞–µ—Ç—Å—è –æ—Ç —Å–ª—É–∂–µ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ TXT

---

## üìä –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: PDF —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ

```
–ö–æ–¥–µ–∫—Å: –ì—Ä–∞–∂–¥–∞–Ω—Å–∫–∏–π –∫–æ–¥–µ–∫—Å –†–§ (—á–∞—Å—Ç—å 1)
‚îú‚îÄ –®–ê–ì 1: –ü—Ä–æ–±—É–µ–º PDF —á–µ—Ä–µ–∑ API
‚îÇ  ‚îî‚îÄ ‚úÖ –°–∫–∞—á–∞–Ω: 5.2 –ú–ë, 645 —Å—Ç—Ä–∞–Ω–∏—Ü
‚îÇ     ‚îî‚îÄ –≠—Ç–æ –ø–æ–ª–Ω—ã–π –∫–æ–¥–µ–∫—Å! –ò—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ.
‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: –°–æ—Ö—Ä–∞–Ω–µ–Ω PDF —Ñ–∞–π–ª (5.2 –ú–ë)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: PDF –º–∞–ª–µ–Ω—å–∫–∏–π, HTML —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ

```
–ö–æ–¥–µ–∫—Å: –¢—Ä—É–¥–æ–≤–æ–π –∫–æ–¥–µ–∫—Å –†–§
‚îú‚îÄ –®–ê–ì 1: –ü—Ä–æ–±—É–µ–º PDF —á–µ—Ä–µ–∑ API
‚îÇ  ‚îî‚îÄ ‚ö†Ô∏è –°–∫–∞—á–∞–Ω: 0.2 –ú–ë, 3 —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚îÇ     ‚îî‚îÄ –≠—Ç–æ –∑–∞–≥–ª—É—à–∫–∞, –ø—Ä–æ–±—É–µ–º HTML
‚îú‚îÄ –®–ê–ì 2: –ü–∞—Ä—Å–∏–º HTML
‚îÇ  ‚îî‚îÄ ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω —Ç–µ–∫—Å—Ç: 850 –ö–ë, –ø–æ–ª–Ω—ã–π –∫–æ–¥–µ–∫—Å
‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: –°–æ—Ö—Ä–∞–Ω–µ–Ω TXT —Ñ–∞–π–ª (850 –ö–ë)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û–±–∞ –º–µ—Ç–æ–¥–∞ —Ä–∞–±–æ—Ç–∞—é—Ç ‚úÖ

```
–ö–æ–¥–µ–∫—Å: –ù–∞–ª–æ–≥–æ–≤—ã–π –∫–æ–¥–µ–∫—Å –†–§ (—á–∞—Å—Ç—å 1)
‚îú‚îÄ –®–ê–ì 1: –ü—Ä–æ–±—É–µ–º PDF —á–µ—Ä–µ–∑ API
‚îÇ  ‚îî‚îÄ ‚úÖ –°–∫–∞—á–∞–Ω: 6.8 –ú–ë, 520 —Å—Ç—Ä–∞–Ω–∏—Ü
‚îÇ     ‚îî‚îÄ –≠—Ç–æ –ø–æ–ª–Ω—ã–π –∫–æ–¥–µ–∫—Å!
‚îú‚îÄ –®–ê–ì 2: –ü–∞—Ä—Å–∏–º HTML (–Ω–µ –Ω—É–∂–µ–Ω, –Ω–æ –º–æ–∂–Ω–æ)
‚îÇ  ‚îî‚îÄ ‚è≠Ô∏è –ü—Ä–æ–ø—É—â–µ–Ω (—É–∂–µ –µ—Å—Ç—å PDF)
‚îî‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç: –°–æ—Ö—Ä–∞–Ω–µ–Ω PDF —Ñ–∞–π–ª (6.8 –ú–ë)
```

---

## üé® –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏

```
data/codes_downloads/
‚îú‚îÄ‚îÄ 0001201410140002_–ì—Ä–∞–∂–¥–∞–Ω—Å–∫–∏–π_–∫–æ–¥–µ–∫—Å_–†–§_—á–∞—Å—Ç—å_1.pdf  (5.2 –ú–ë) ‚úÖ
‚îú‚îÄ‚îÄ –¢—Ä—É–¥–æ–≤–æ–π_–∫–æ–¥–µ–∫—Å_–†–§.txt                               (850 –ö–ë) ‚úÖ
‚îú‚îÄ‚îÄ –ù–∞–ª–æ–≥–æ–≤—ã–π_–∫–æ–¥–µ–∫—Å_–†–§_—á–∞—Å—Ç—å_1.pdf                      (6.8 –ú–ë) ‚úÖ
‚îî‚îÄ‚îÄ hybrid_download_report_20251106_120000.json          (–æ—Ç—á–µ—Ç)
```

**–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–æ–≤:**
- PDF —Ñ–∞–π–ª—ã - –µ—Å–ª–∏ —Å–∫–∞—á–∞–Ω—ã —á–µ—Ä–µ–∑ API
- TXT —Ñ–∞–π–ª—ã - –µ—Å–ª–∏ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω—ã –∏–∑ HTML
- JSON –æ—Ç—á–µ—Ç - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–Ω–æ—Ç—ã PDF:

```python
MIN_FULL_CODEX_SIZE = 500 * 1024  # 500 –ö–ë
MIN_PAGES_COUNT = 50               # 50 —Å—Ç—Ä–∞–Ω–∏—Ü

if pdf_size >= MIN_FULL_CODEX_SIZE and pages >= MIN_PAGES_COUNT:
    # –≠—Ç–æ –ø–æ–ª–Ω—ã–π –∫–æ–¥–µ–∫—Å!
    use_pdf = True
else:
    # –≠—Ç–æ –∑–∞–≥–ª—É—à–∫–∞, –ø—Ä–æ–±—É–µ–º HTML
    use_pdf = False
```

### –£–ª—É—á—à–µ–Ω–Ω—ã–π HTML –ø–∞—Ä—Å–∏–Ω–≥:

```javascript
// –£–±–∏—Ä–∞–µ–º —Å–ª—É–∂–µ–±–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
var elements = document.querySelectorAll('script, style, nav, header, footer');
elements.forEach(el => el.remove());

// –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
var content = document.querySelector('.view-col-contaner') || 
              document.querySelector('.document-content') ||
              document.body;

return content.innerText;
```

---

## üìà –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤

| –ú–µ—Ç–æ–¥ | –°–∫–æ—Ä–æ—Å—Ç—å | –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å | –ö–∞—á–µ—Å—Ç–≤–æ | –§–æ—Ä–º–∞—Ç |
|-------|----------|------------|----------|--------|
| PDF —á–µ—Ä–µ–∑ API | ‚ö°‚ö°‚ö° –ë—ã—Å—Ç—Ä–æ | ‚ö†Ô∏è –ó–∞–≤–∏—Å–∏—Ç –æ—Ç eo_number | ‚úÖ‚úÖ‚úÖ –ò–¥–µ–∞–ª—å–Ω–æ | PDF |
| HTML –ø–∞—Ä—Å–∏–Ω–≥ | ‚ö°‚ö° –°—Ä–µ–¥–Ω–µ | ‚úÖ‚úÖ‚úÖ –í—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç | ‚úÖ‚úÖ –•–æ—Ä–æ—à–æ | TXT |
| **–ì–∏–±—Ä–∏–¥–Ω—ã–π** | ‚ö°‚ö°‚ö° –ë—ã—Å—Ç—Ä–æ | ‚úÖ‚úÖ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è | ‚úÖ‚úÖ‚úÖ –õ—É—á—à–µ–µ | PDF/TXT |

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ó–∞–ø—É—Å–∫:

```bash
cd /root/advakod
python3 backend/scripts/hybrid_download_codes.py
```

### –í –∫–æ–¥–µ:

```python
from app.services.hybrid_codes_downloader import HybridCodesDownloader

async with HybridCodesDownloader() as downloader:
    summary = await downloader.download_all_codexes()
    
    print(f"–£—Å–ø–µ—à–Ω–æ: {summary['successful']}/{summary['total_codexes']}")
    print(f"–†–∞–∑–º–µ—Ä: {summary['total_size_mb']} –ú–ë")
```

---

## ‚úÖ –ò—Ç–æ–≥

**–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ = –õ—É—á—à–µ–µ –∏–∑ –æ–±–æ–∏—Ö –º–∏—Ä–æ–≤!**

- ‚úÖ –ë—ã—Å—Ç—Ä–æ (—Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ—Ç PDF)
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ (HTML –ø–∞—Ä—Å–∏–Ω–≥ –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤)
- ‚úÖ –£–º–Ω–æ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç)
- ‚úÖ –ü–æ–ª–Ω–æ (–≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—Ç —á—Ç–æ-—Ç–æ)

**–≠—Ç–æ —Å–∞–º–æ–µ –Ω–∞–¥–µ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ!**

