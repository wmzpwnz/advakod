/*! For license information please see 783.d2f75596.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkai_lawyer_frontend=self.webpackChunkai_lawyer_frontend||[]).push([[783],{3783:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var r=a(5043),s=a(5613),l=a(6210),d=a(2313),c=a(2489),n=a(3005),i=a(9722),x=a(579);const o=e=>{let{onSetupComplete:t,onCancel:a}=e;const[o,m]=(0,r.useState)(1),[y,g]=(0,r.useState)(""),[h,b]=(0,r.useState)(""),[u,p]=(0,r.useState)([]),[j,N]=(0,r.useState)(""),[k,f]=(0,r.useState)(!1),[v,w]=(0,r.useState)(""),[A,C]=(0,r.useState)(!1),{isDark:S}=(0,n.D)();(0,r.useEffect)(()=>{R()},[]);const R=async()=>{try{f(!0);const e=await i.A.post("/api/v1/2fa/setup");g(e.data.qr_code),b(e.data.secret),p(e.data.backup_codes),m(1)}catch(v){w("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0435 2FA"),console.error("2FA setup error:",v)}finally{f(!1)}};return k&&1===o?(0,x.jsxs)("div",{className:"flex items-center justify-center p-8",children:[(0,x.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),(0,x.jsx)("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 2FA..."})]}):(0,x.jsxs)("div",{className:"max-w-md mx-auto p-6 bg-white dark:bg-gray-800 rounded-lg shadow-lg",children:[(0,x.jsxs)("div",{className:"text-center mb-6",children:[(0,x.jsx)("div",{className:"mx-auto w-12 h-12 bg-primary-100 dark:bg-primary-900/30 rounded-full flex items-center justify-center mb-4",children:(0,x.jsx)(c.A,{className:"h-6 w-6 text-primary-600"})}),(0,x.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0434\u0432\u0443\u0445\u0444\u0430\u043a\u0442\u043e\u0440\u043d\u043e\u0439 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438"}),(0,x.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"\u0417\u0430\u0449\u0438\u0442\u0438\u0442\u0435 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u0443\u0440\u043e\u0432\u043d\u0435\u043c \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438"})]}),v&&(0,x.jsxs)("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg flex items-center space-x-2",children:[(0,x.jsx)(s.A,{className:"h-4 w-4 text-red-500"}),(0,x.jsx)("span",{className:"text-sm text-red-600 dark:text-red-400",children:v})]}),1===o&&(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{className:"text-center",children:[(0,x.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"\u0428\u0430\u0433 1: \u0421\u043a\u0430\u043d\u0438\u0440\u0443\u0439\u0442\u0435 QR-\u043a\u043e\u0434"}),(0,x.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"\u041e\u0442\u0441\u043a\u0430\u043d\u0438\u0440\u0443\u0439\u0442\u0435 QR-\u043a\u043e\u0434 \u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438 Google Authenticator \u0438\u043b\u0438 \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u043d\u043e\u043c"})]}),(0,x.jsx)("div",{className:"flex justify-center",children:(0,x.jsx)("div",{className:"p-4 bg-white rounded-lg border border-gray-200 dark:border-gray-700",children:(0,x.jsx)("img",{src:y,alt:"2FA QR Code",className:"w-48 h-48"})})}),(0,x.jsxs)("div",{className:"text-center",children:[(0,x.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"\u0418\u043b\u0438 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0435\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043a\u043b\u044e\u0447 \u0432\u0440\u0443\u0447\u043d\u0443\u044e:"}),(0,x.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,x.jsx)("code",{className:"px-3 py-2 bg-gray-100 dark:bg-gray-700 rounded text-sm font-mono",children:h}),(0,x.jsx)("button",{onClick:()=>(async e=>{try{await navigator.clipboard.writeText(e),C(!0),setTimeout(()=>C(!1),2e3)}catch(t){console.error("Failed to copy:",t)}})(h),className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:A?(0,x.jsx)(l.A,{className:"h-4 w-4"}):(0,x.jsx)(d.A,{className:"h-4 w-4"})})]})]}),(0,x.jsx)("button",{onClick:()=>m(2),className:"w-full btn-primary",children:"\u0414\u0430\u043b\u0435\u0435"})]}),2===o&&(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{className:"text-center",children:[(0,x.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"\u0428\u0430\u0433 2: \u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u043a\u043e\u0434"}),(0,x.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 6-\u0437\u043d\u0430\u0447\u043d\u044b\u0439 \u043a\u043e\u0434 \u0438\u0437 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u0430"})]}),(0,x.jsx)("div",{children:(0,x.jsx)("input",{type:"text",value:j,onChange:e=>N(e.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"w-full px-4 py-3 text-center text-2xl font-mono border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",maxLength:6})}),(0,x.jsxs)("div",{className:"flex space-x-3",children:[(0,x.jsx)("button",{onClick:()=>m(1),className:"flex-1 btn-secondary",children:"\u041d\u0430\u0437\u0430\u0434"}),(0,x.jsx)("button",{onClick:async()=>{if(j.trim())try{f(!0),w("");(await i.A.post("/api/v1/2fa/confirm",{token:j})).data.enabled&&m(3)}catch(v){var e,t;w((null===(e=v.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043a\u043e\u0434")}finally{f(!1)}else w("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u0438\u0437 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f")},disabled:k||6!==j.length,className:"flex-1 btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:k?"\u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430...":"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c"})]})]}),3===o&&(0,x.jsxs)("div",{className:"space-y-4",children:[(0,x.jsxs)("div",{className:"text-center",children:[(0,x.jsx)("div",{className:"mx-auto w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mb-4",children:(0,x.jsx)(l.A,{className:"h-6 w-6 text-green-600"})}),(0,x.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"2FA \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d!"}),(0,x.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u0435 \u0440\u0435\u0437\u0435\u0440\u0432\u043d\u044b\u0435 \u043a\u043e\u0434\u044b \u0432 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u043c \u043c\u0435\u0441\u0442\u0435"})]}),(0,x.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:(0,x.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,x.jsx)(s.A,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),(0,x.jsxs)("div",{children:[(0,x.jsx)("p",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"\u0412\u0430\u0436\u043d\u043e!"}),(0,x.jsx)("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:"\u0420\u0435\u0437\u0435\u0440\u0432\u043d\u044b\u0435 \u043a\u043e\u0434\u044b \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0434\u0438\u043d \u0440\u0430\u0437. \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u0435 \u0438\u0445 \u0432 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u043c \u043c\u0435\u0441\u0442\u0435."})]})]})}),(0,x.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,x.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"\u0420\u0435\u0437\u0435\u0440\u0432\u043d\u044b\u0435 \u043a\u043e\u0434\u044b:"}),(0,x.jsx)("button",{onClick:()=>{const e=u.join("\n"),t=new Blob([e],{type:"text/plain"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download="backup-codes.txt",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)},className:"text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400",children:"\u0421\u043a\u0430\u0447\u0430\u0442\u044c"})]}),(0,x.jsx)("div",{className:"grid grid-cols-2 gap-2",children:u.map((e,t)=>(0,x.jsx)("div",{className:"px-3 py-2 bg-white dark:bg-gray-800 rounded border border-gray-200 dark:border-gray-600 text-sm font-mono text-center",children:e},t))})]}),(0,x.jsx)("button",{onClick:t,className:"w-full btn-primary",children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0443"})]}),(0,x.jsx)("div",{className:"mt-6 text-center",children:(0,x.jsx)("button",{onClick:a,className:"text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"\u041e\u0442\u043c\u0435\u043d\u0430"})})]})}},6210:(e,t,a)=>{a.d(t,{A:()=>r});const r=(0,a(1639).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])}}]);
//# sourceMappingURL=783.d2f75596.chunk.js.map