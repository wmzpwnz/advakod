{"version":3,"file":"static/js/578.d7a14bbc.chunk.js","mappings":"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","sources":["services/ResilientWebSocket.js","hooks/useChatWebSocket.js","hooks/useStatusNotifications.js","components/VoiceRecorder.js","components/ChatHistory.js","components/EnhancedResponse.js","components/FeedbackButtons.js","components/ErrorMessage.js","components/AIThinkingIndicator.js","components/EnhancedConnectionStatus.js","components/StatusNotificationSystem.js","pages/Chat.js"],"sourcesContent":["/**\n * ResilientWebSocket -  WebSocket    \n *   2.2, 2.3, 6.3  \n */\nclass ResilientWebSocket {\n  constructor(url, options = {}) {\n    this.url = url;\n    this.options = {\n      maxReconnectAttempts: 10,\n      reconnectDelay: 1000,\n      maxReconnectDelay: 30000,\n      pingInterval: 30000,\n      pongTimeout: 10000,\n      connectionTimeout: 10000,\n      maxMessageSize: 65536, // 64KB\n      enableHeartbeat: true,\n      enableAutoReconnect: true,\n      enableErrorRecovery: true,\n      ...options\n    };\n\n    this.ws = null;\n    this.reconnectAttempts = 0;\n    this.isConnected = false;\n    this.isConnecting = false;\n    this.shouldReconnect = true;\n\n    // Event listeners\n    this.listeners = new Map();\n\n    // Ping/Pong   \n    this.pingInterval = null;\n    this.pongTimeout = null;\n    this.lastPong = null;\n\n    //      \n    this.messageQueue = [];\n    this.maxQueueSize = 100;\n\n    //  \n    this.connectionStats = {\n      totalConnections: 0,\n      totalReconnections: 0,\n      totalMessages: 0,\n      totalErrors: 0,\n      lastConnectedAt: null,\n      lastDisconnectedAt: null,\n      connectionDuration: 0,\n      averageLatency: 0,\n      errorRate: 0\n    };\n\n    //    UI\n    this.connectionState = 'disconnected'; // 'connecting', 'connected', 'reconnecting', 'disconnected', 'failed'\n    \n    //    \n    this.errorRecovery = {\n      consecutiveErrors: 0,\n      lastErrorTime: null,\n      errorTypes: new Map(),\n      recoveryStrategies: new Map()\n    };\n    \n    //   \n    this.initializeRecoveryStrategies();\n  }\n\n  /**\n   *     \n   */\n  initializeRecoveryStrategies() {\n    //    \n    this.errorRecovery.recoveryStrategies.set('auth_error', {\n      maxAttempts: 3,\n      delay: 5000,\n      action: async () => {\n        console.log('ResilientWebSocket: Attempting auth recovery...');\n        //     \n        this.emit('authRecoveryNeeded');\n      }\n    });\n    \n    //    \n    this.errorRecovery.recoveryStrategies.set('network_error', {\n      maxAttempts: 5,\n      delay: 2000,\n      action: async () => {\n        console.log('ResilientWebSocket: Attempting network recovery...');\n        //   \n        if (navigator.onLine) {\n          return true; //  ,  \n        }\n        return false; //  , \n      }\n    });\n    \n    //    \n    this.errorRecovery.recoveryStrategies.set('server_error', {\n      maxAttempts: 3,\n      delay: 10000,\n      action: async () => {\n        console.log('ResilientWebSocket: Attempting server error recovery...');\n        //     \n        return true;\n      }\n    });\n  }\n\n  /**\n   *   WebSocket\n   */\n  async connect() {\n    if (this.isConnecting || this.isConnected) {\n      return Promise.resolve();\n    }\n\n    this.isConnecting = true;\n    this.shouldReconnect = true;\n\n    return new Promise((resolve, reject) => {\n      try {\n        console.log('ResilientWebSocket: Connecting to', this.url);\n        this.ws = new WebSocket(this.url);\n\n        this.connectionState = 'connecting';\n        this.emit('stateChange', this.connectionState);\n\n        const connectTimeout = setTimeout(() => {\n          if (this.ws && this.ws.readyState === WebSocket.CONNECTING) {\n            this.ws.close();\n            this.connectionState = 'failed';\n            this.emit('stateChange', this.connectionState);\n            reject(new Error('Connection timeout'));\n          }\n        }, this.options.connectionTimeout);\n\n        this.ws.onopen = () => {\n          clearTimeout(connectTimeout);\n          console.log('ResilientWebSocket: Connected successfully');\n          this.isConnected = true;\n          this.isConnecting = false;\n          this.reconnectAttempts = 0;\n          this.connectionState = 'connected';\n\n          //  \n          this.connectionStats.totalConnections++;\n          this.connectionStats.lastConnectedAt = new Date();\n\n          this.startPingPong();\n          this.flushMessageQueue();\n          this.emit('open');\n          this.emit('stateChange', this.connectionState);\n          resolve();\n        };\n\n        this.ws.onmessage = (event) => {\n          try {\n            const data = JSON.parse(event.data);\n\n            //  pong \n            if (data.type === 'pong') {\n              this.handlePong(data);\n              return;\n            }\n\n            this.emit('message', data);\n          } catch (error) {\n            console.error('ResilientWebSocket: Error parsing message:', error);\n            this.emit('error', error);\n          }\n        };\n\n        this.ws.onclose = (event) => {\n          clearTimeout(connectTimeout);\n          console.log('ResilientWebSocket: Connection closed:', event.code, event.reason);\n\n          this.isConnected = false;\n          this.isConnecting = false;\n          this.stopPingPong();\n\n          //  \n          this.connectionStats.lastDisconnectedAt = new Date();\n          if (this.connectionStats.lastConnectedAt) {\n            this.connectionStats.connectionDuration +=\n              this.connectionStats.lastDisconnectedAt - this.connectionStats.lastConnectedAt;\n          }\n\n          const shouldReconnect = this.handleClose(event.code, event.reason);\n\n          if (shouldReconnect && this.shouldReconnect) {\n            this.connectionState = 'reconnecting';\n            this.connectionStats.totalReconnections++;\n            this.emit('stateChange', this.connectionState);\n            this.scheduleReconnect();\n          } else {\n            this.connectionState = event.code === 1000 ? 'disconnected' : 'failed';\n            this.emit('stateChange', this.connectionState);\n          }\n\n          this.emit('close', { code: event.code, reason: event.reason, shouldReconnect });\n        };\n\n        this.ws.onerror = (error) => {\n          clearTimeout(connectTimeout);\n          console.error('ResilientWebSocket: Connection error:', error);\n          \n          //   \n          this.connectionStats.totalErrors++;\n          this.errorRecovery.consecutiveErrors++;\n          this.errorRecovery.lastErrorTime = Date.now();\n          \n          //       \n          const errorType = this.classifyError(error);\n          this.handleErrorRecovery(errorType);\n          \n          this.isConnecting = false;\n          this.connectionState = 'failed';\n          this.emit('stateChange', this.connectionState);\n          this.emit('error', { ...error, type: errorType, recoverable: this.isErrorRecoverable(errorType) });\n          reject(error);\n        };\n\n      } catch (error) {\n        this.isConnecting = false;\n        console.error('ResilientWebSocket: Failed to create connection:', error);\n        reject(error);\n      }\n    });\n  }\n\n  /**\n   *   WebSocket\n   */\n  disconnect() {\n    console.log('ResilientWebSocket: Disconnecting...');\n    this.shouldReconnect = false;\n    this.stopPingPong();\n\n    if (this.ws) {\n      this.ws.close(1000, 'Client disconnect');\n      this.ws = null;\n    }\n\n    this.isConnected = false;\n    this.isConnecting = false;\n    this.messageQueue = [];\n  }\n\n  /**\n   *      \n   */\n  send(data) {\n    const message = typeof data === 'string' ? data : JSON.stringify(data);\n\n    //   \n    if (message.length > this.options.maxMessageSize) {\n      console.error('ResilientWebSocket: Message too large:', message.length, 'bytes');\n      this.emit('error', {\n        type: 'message_too_large',\n        message: 'Message exceeds maximum size',\n        size: message.length,\n        maxSize: this.options.maxMessageSize\n      });\n      return false;\n    }\n\n    if (this.isConnected && this.ws && this.ws.readyState === WebSocket.OPEN) {\n      try {\n        this.ws.send(message);\n        this.connectionStats.totalMessages++;\n        this.emit('messageSent', { size: message.length });\n        return true;\n      } catch (error) {\n        console.error('ResilientWebSocket: Error sending message:', error);\n        this.connectionStats.totalErrors++;\n        \n        //   \n        const errorType = this.classifyError(error);\n        this.handleErrorRecovery(errorType);\n        \n        //      \n        this.queueMessage(message);\n        \n        this.emit('error', {\n          type: 'send_error',\n          originalError: error,\n          message: 'Failed to send message',\n          queued: true\n        });\n        \n        return false;\n      }\n    } else {\n      //    -   \n      this.queueMessage(message);\n      \n      //    \n      if (!this.isConnecting && this.shouldReconnect && this.options.enableAutoReconnect) {\n        console.log('ResilientWebSocket: Connection lost, attempting to reconnect for message delivery');\n        this.connect().catch(error => {\n          console.error('ResilientWebSocket: Failed to reconnect for message delivery:', error);\n        });\n      }\n      \n      return false;\n    }\n  }\n\n  /**\n   *    \n   */\n  queueMessage(message) {\n    if (this.messageQueue.length >= this.maxQueueSize) {\n      this.messageQueue.shift(); //   \n    }\n    this.messageQueue.push(message);\n  }\n\n  /**\n   *     \n   */\n  flushMessageQueue() {\n    while (this.messageQueue.length > 0 && this.isConnected) {\n      const message = this.messageQueue.shift();\n      try {\n        this.ws.send(message);\n      } catch (error) {\n        console.error('ResilientWebSocket: Error flushing message queue:', error);\n        //    \n        this.messageQueue.unshift(message);\n        break;\n      }\n    }\n  }\n\n  /**\n   *      \n   */\n  classifyError(error) {\n    if (error.code === 1008 || error.code === 1003) {\n      return 'auth_error';\n    } else if (error.code === 1011 || error.code === 1001) {\n      return 'server_error';\n    } else if (error.code === 1006 || !navigator.onLine) {\n      return 'network_error';\n    } else {\n      return 'unknown_error';\n    }\n  }\n\n  /**\n   * ,     \n   */\n  isErrorRecoverable(errorType) {\n    const nonRecoverableErrors = ['auth_error'];\n    return !nonRecoverableErrors.includes(errorType) && this.options.enableErrorRecovery;\n  }\n\n  /**\n   *    \n   */\n  async handleErrorRecovery(errorType) {\n    if (!this.options.enableErrorRecovery) {\n      return false;\n    }\n\n    const strategy = this.errorRecovery.recoveryStrategies.get(errorType);\n    if (!strategy) {\n      console.warn(`ResilientWebSocket: No recovery strategy for error type: ${errorType}`);\n      return false;\n    }\n\n    //   \n    const errorCount = this.errorRecovery.errorTypes.get(errorType) || 0;\n    if (errorCount >= strategy.maxAttempts) {\n      console.warn(`ResilientWebSocket: Max recovery attempts reached for ${errorType}`);\n      this.emit('maxRecoveryAttemptsReached', { errorType, attempts: errorCount });\n      return false;\n    }\n\n    //   \n    this.errorRecovery.errorTypes.set(errorType, errorCount + 1);\n\n    try {\n      //   \n      const canRecover = await strategy.action();\n      \n      if (canRecover !== false) {\n        console.log(`ResilientWebSocket: Recovery strategy for ${errorType} completed`);\n        this.emit('errorRecoveryAttempt', { errorType, attempt: errorCount + 1 });\n        return true;\n      }\n    } catch (recoveryError) {\n      console.error(`ResilientWebSocket: Recovery strategy failed for ${errorType}:`, recoveryError);\n    }\n\n    return false;\n  }\n\n  /**\n   *   \n   */\n  handleClose(code, reason) {\n    const errorMap = {\n      1008: 'Authentication failed',\n      1003: 'Access denied', \n      1011: 'Server error',\n      1006: 'Connection lost',\n      1000: 'Normal closure',\n      1001: 'Going away',\n      1009: 'Message too big'\n    };\n\n    const message = errorMap[code] || 'Unknown error';\n    console.log(`ResilientWebSocket closed: ${code} - ${message} (${reason})`);\n\n    //  \n    const errorType = this.classifyError({ code, reason });\n    \n    //  \n    if (code !== 1000) { //     \n      this.connectionStats.totalErrors++;\n      this.errorRecovery.consecutiveErrors++;\n    } else {\n      this.errorRecovery.consecutiveErrors = 0; //    \n    }\n\n    // ,   \n    const permanentErrors = [1008, 1003]; //    \n    const shouldReconnect = !permanentErrors.includes(code) && this.isErrorRecoverable(errorType);\n    \n    if (shouldReconnect) {\n      //   \n      this.handleErrorRecovery(errorType);\n    }\n\n    return shouldReconnect;\n  }\n\n  /**\n   *      \n   */\n  scheduleReconnect() {\n    if (!this.options.enableAutoReconnect) {\n      console.log('ResilientWebSocket: Auto-reconnect disabled');\n      return;\n    }\n\n    if (this.reconnectAttempts >= this.options.maxReconnectAttempts) {\n      console.log('ResilientWebSocket: Max reconnection attempts reached');\n      this.connectionState = 'failed';\n      this.emit('stateChange', this.connectionState);\n      this.emit('maxReconnectAttemptsReached', {\n        attempts: this.reconnectAttempts,\n        consecutiveErrors: this.errorRecovery.consecutiveErrors\n      });\n      return;\n    }\n\n    //     \n    if (!navigator.onLine) {\n      console.log('ResilientWebSocket: Network offline, waiting for connection...');\n      this.waitForNetworkRecovery();\n      return;\n    }\n\n    this.reconnectAttempts++;\n    \n    //      \n    let baseDelay = this.options.reconnectDelay;\n    \n    //     \n    if (this.errorRecovery.consecutiveErrors > 3) {\n      baseDelay *= 2;\n    }\n    \n    const delay = Math.min(\n      baseDelay * Math.pow(2, this.reconnectAttempts - 1),\n      this.options.maxReconnectDelay\n    );\n\n    console.log(`ResilientWebSocket: Scheduling reconnect attempt ${this.reconnectAttempts} in ${delay}ms`);\n    \n    this.emit('reconnectScheduled', {\n      attempt: this.reconnectAttempts,\n      delay: delay,\n      consecutiveErrors: this.errorRecovery.consecutiveErrors\n    });\n\n    setTimeout(() => {\n      if (this.shouldReconnect && !this.isConnected && !this.isConnecting) {\n        this.attemptReconnect();\n      }\n    }, delay);\n  }\n\n  /**\n   *     \n   */\n  async attemptReconnect() {\n    try {\n      //   \n      if (!navigator.onLine) {\n        console.log('ResilientWebSocket: Network still offline, postponing reconnect');\n        this.scheduleReconnect();\n        return;\n      }\n\n      // ,     \n      if (this.errorRecovery.consecutiveErrors > 10) {\n        console.warn('ResilientWebSocket: Too many consecutive errors, extending delay');\n        setTimeout(() => this.scheduleReconnect(), 30000); // 30   \n        return;\n      }\n\n      console.log(`ResilientWebSocket: Attempting reconnect ${this.reconnectAttempts}/${this.options.maxReconnectAttempts}`);\n      await this.connect();\n      \n      //   -   \n      this.errorRecovery.consecutiveErrors = 0;\n      this.errorRecovery.errorTypes.clear();\n      \n    } catch (error) {\n      console.error('ResilientWebSocket: Reconnection failed:', error);\n      // scheduleReconnect      \n    }\n  }\n\n  /**\n   *    \n   */\n  waitForNetworkRecovery() {\n    const checkNetwork = () => {\n      if (navigator.onLine && this.shouldReconnect) {\n        console.log('ResilientWebSocket: Network recovered, attempting reconnect');\n        window.removeEventListener('online', checkNetwork);\n        this.scheduleReconnect();\n      }\n    };\n\n    window.addEventListener('online', checkNetwork);\n    \n    //     ,    \n    const intervalCheck = setInterval(() => {\n      if (navigator.onLine && this.shouldReconnect) {\n        clearInterval(intervalCheck);\n        window.removeEventListener('online', checkNetwork);\n        this.scheduleReconnect();\n      } else if (!this.shouldReconnect) {\n        clearInterval(intervalCheck);\n        window.removeEventListener('online', checkNetwork);\n      }\n    }, 5000);\n  }\n\n  /**\n   *  ping/pong \n   */\n  startPingPong() {\n    this.stopPingPong();\n\n    this.pingInterval = setInterval(() => {\n      if (this.isConnected && this.ws && this.ws.readyState === WebSocket.OPEN) {\n        const pingData = {\n          type: 'ping',\n          timestamp: Date.now()\n        };\n\n        this.ws.send(JSON.stringify(pingData));\n\n        //    pong\n        this.pongTimeout = setTimeout(() => {\n          console.warn('ResilientWebSocket: Pong timeout, reconnecting...');\n          this.ws.close(1006, 'Pong timeout');\n        }, this.options.pongTimeout);\n      }\n    }, this.options.pingInterval);\n  }\n\n  /**\n   *  ping/pong \n   */\n  stopPingPong() {\n    if (this.pingInterval) {\n      clearInterval(this.pingInterval);\n      this.pingInterval = null;\n    }\n\n    if (this.pongTimeout) {\n      clearTimeout(this.pongTimeout);\n      this.pongTimeout = null;\n    }\n  }\n\n  /**\n   *  pong \n   */\n  handlePong(data) {\n    if (this.pongTimeout) {\n      clearTimeout(this.pongTimeout);\n      this.pongTimeout = null;\n    }\n\n    this.lastPong = Date.now();\n    console.log('ResilientWebSocket: Pong received');\n  }\n\n  /**\n   *   \n   */\n  on(event, callback) {\n    if (!this.listeners.has(event)) {\n      this.listeners.set(event, new Set());\n    }\n    this.listeners.get(event).add(callback);\n  }\n\n  /**\n   *   \n   */\n  off(event, callback) {\n    if (this.listeners.has(event)) {\n      this.listeners.get(event).delete(callback);\n    }\n  }\n\n  /**\n   *   \n   */\n  emit(event, ...args) {\n    if (this.listeners.has(event)) {\n      this.listeners.get(event).forEach(callback => {\n        try {\n          callback(...args);\n        } catch (error) {\n          console.error(`ResilientWebSocket: Error in event listener for ${event}:`, error);\n        }\n      });\n    }\n  }\n\n  /**\n   *   \n   */\n  getStatus() {\n    return {\n      connected: this.isConnected,\n      connecting: this.isConnecting,\n      readyState: this.ws ? this.ws.readyState : WebSocket.CLOSED,\n      reconnectAttempts: this.reconnectAttempts,\n      lastPong: this.lastPong,\n      queuedMessages: this.messageQueue.length,\n      connectionState: this.connectionState,\n      stats: { ...this.connectionStats }\n    };\n  }\n\n  /**\n   *     UI\n   */\n  getUserFriendlyStatus() {\n    const statusMap = {\n      'connecting': { text: '...', color: 'yellow', icon: 'connecting' },\n      'connected': { text: '', color: 'green', icon: 'connected' },\n      'reconnecting': { text: '...', color: 'orange', icon: 'reconnecting' },\n      'disconnected': { text: '', color: 'gray', icon: 'disconnected' },\n      'failed': { text: ' ', color: 'red', icon: 'error' }\n    };\n\n    return statusMap[this.connectionState] || statusMap['disconnected'];\n  }\n\n  /**\n   *  \n   */\n  reconnect() {\n    console.log('ResilientWebSocket: Force reconnecting...');\n    \n    //      \n    this.errorRecovery.consecutiveErrors = 0;\n    this.errorRecovery.errorTypes.clear();\n    this.reconnectAttempts = 0;\n    \n    if (this.ws) {\n      this.ws.close(1000, 'Force reconnect');\n    }\n    \n    this.shouldReconnect = true;\n    this.connect();\n  }\n\n  /**\n   *     \n   */\n  resetErrorRecovery() {\n    console.log('ResilientWebSocket: Resetting error recovery system');\n    this.errorRecovery.consecutiveErrors = 0;\n    this.errorRecovery.lastErrorTime = null;\n    this.errorRecovery.errorTypes.clear();\n    this.reconnectAttempts = 0;\n    this.emit('errorRecoveryReset');\n  }\n\n  /**\n   *   \n   */\n  checkConnectionHealth() {\n    const now = Date.now();\n    const health = {\n      connected: this.isConnected,\n      connectionState: this.connectionState,\n      consecutiveErrors: this.errorRecovery.consecutiveErrors,\n      reconnectAttempts: this.reconnectAttempts,\n      queuedMessages: this.messageQueue.length,\n      lastPong: this.lastPong,\n      timeSinceLastPong: this.lastPong ? now - this.lastPong : null,\n      networkOnline: navigator.onLine,\n      stats: { ...this.connectionStats }\n    };\n\n    //   \n    health.isHealthy = this.isConnected && \n                      this.errorRecovery.consecutiveErrors < 3 &&\n                      (!this.lastPong || (now - this.lastPong) < 60000); //  pong   \n\n    health.errorRate = this.connectionStats.totalMessages > 0 ? \n                      this.connectionStats.totalErrors / this.connectionStats.totalMessages : 0;\n\n    return health;\n  }\n\n  /**\n   *    \n   */\n  getRecoveryRecommendations() {\n    const health = this.checkConnectionHealth();\n    const recommendations = [];\n\n    if (!navigator.onLine) {\n      recommendations.push({\n        type: 'network',\n        message: '   ',\n        action: 'checkNetwork'\n      });\n    }\n\n    if (health.consecutiveErrors > 5) {\n      recommendations.push({\n        type: 'errors',\n        message: '   .   ',\n        action: 'pageReload'\n      });\n    }\n\n    if (health.reconnectAttempts > 5) {\n      recommendations.push({\n        type: 'reconnect',\n        message: '  .  ',\n        action: 'checkServer'\n      });\n    }\n\n    if (health.queuedMessages > 10) {\n      recommendations.push({\n        type: 'queue',\n        message: '   ',\n        action: 'clearQueue'\n      });\n    }\n\n    if (health.errorRate > 0.1) {\n      recommendations.push({\n        type: 'errorRate',\n        message: '  .    ',\n        action: 'contactSupport'\n      });\n    }\n\n    return recommendations;\n  }\n\n  /**\n   *    \n   */\n  applyRecoveryRecommendation(action) {\n    switch (action) {\n      case 'checkNetwork':\n        //     \n        this.waitForNetworkRecovery();\n        break;\n        \n      case 'pageReload':\n        //   \n        this.emit('recommendPageReload');\n        break;\n        \n      case 'checkServer':\n        //   \n        this.options.reconnectDelay = Math.min(this.options.reconnectDelay * 2, 30000);\n        break;\n        \n      case 'clearQueue':\n        //   \n        this.messageQueue = [];\n        this.emit('queueCleared');\n        break;\n        \n      case 'contactSupport':\n        //      \n        this.emit('contactSupportRecommended', {\n          errorRate: this.connectionStats.totalErrors / this.connectionStats.totalMessages,\n          totalErrors: this.connectionStats.totalErrors\n        });\n        break;\n    }\n  }\n}\n\nexport default ResilientWebSocket;","import { useAuth } from '../contexts/AuthContext';\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport ResilientWebSocket from '../services/ResilientWebSocket';\nimport { WS_BASE_URL } from '../config/api';\n\n/**\n *   WebSocket \n */\nconst handleWebSocketClose = (code, reason) => {\n  const errorMap = {\n    1008: 'Authentication failed',\n    1003: 'Access denied', \n    1011: 'Server error',\n    1006: 'Connection lost',\n    1000: 'Normal closure'\n  };\n  \n  const message = errorMap[code] || 'Unknown error';\n  console.log(`WebSocket closed: ${code} - ${message} (${reason})`);\n  \n  //       \n  const permanentErrors = [1008, 1003];\n  return !permanentErrors.includes(code);\n};\n\n/**\n *   WebSocket    ResilientWebSocket\n *   2.2, 2.3, 6.3  \n */\nexport const useChatWebSocket = (sessionId, onNewMessage, onTyping, onSessionUpdate) => {\n  const { user } = useAuth();\n  const typingTimeoutRef = useRef(null);\n  const isTypingRef = useRef(false);\n  const websocketRef = useRef(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const [connectionState, setConnectionState] = useState('disconnected');\n\n  //   ResilientWebSocket \n  const createWebSocket = useCallback(() => {\n    if (!user) return null;\n    \n    const token = localStorage.getItem('token');\n    if (!token) return null;\n    \n    //      \n    if (websocketRef.current) {\n      websocketRef.current.disconnect();\n      websocketRef.current = null;\n    }\n    \n    //    sessionId\n    const cleanSessionId = sessionId ? String(sessionId).replace(/[^0-9]/g, '') : null;\n    \n    //     WebSocket URL ( localhost  )\n    const wsBaseUrl = process.env.REACT_APP_WS_URL || WS_BASE_URL;\n    \n    let url;\n    if (cleanSessionId && cleanSessionId.length > 0) {\n      url = `${wsBaseUrl}/session/${cleanSessionId}?token=${token}`;\n    } else {\n      url = `${wsBaseUrl}/general?token=${token}`;\n    }\n    \n    console.log('Creating ResilientWebSocket connection to:', url);\n    \n    try {\n      const ws = new ResilientWebSocket(url, {\n        maxReconnectAttempts: 10,\n        reconnectDelay: 1000,\n        maxReconnectDelay: 30000,\n        pingInterval: 30000,\n        pongTimeout: 10000\n      });\n      \n      websocketRef.current = ws;\n      \n      //  \n      ws.on('open', () => {\n        console.log('ResilientWebSocket connected successfully');\n        setIsConnected(true);\n      });\n      \n      ws.on('close', ({ code, reason }) => {\n        console.log('ResilientWebSocket closed:', code, reason);\n        setIsConnected(false);\n      });\n      \n      ws.on('stateChange', (state) => {\n        console.log('ResilientWebSocket state changed:', state);\n        setConnectionState(state);\n        setIsConnected(state === 'connected');\n      });\n      \n      ws.on('message', (data) => {\n        console.log('ResilientWebSocket message received:', data);\n        \n        if (data.type === 'pong') {\n          console.log('Pong received');\n          return;\n        }\n        \n        //   \n        switch (data.type) {\n          case 'new_message':\n            onNewMessage?.(data.data);\n            break;\n          case 'typing':\n            onTyping?.(data.user_id, data.is_typing);\n            break;\n          case 'session_update':\n            onSessionUpdate?.(data.data);\n            break;\n          case 'generation_stopped':\n            console.log('Generation stopped:', data.message);\n            break;\n          default:\n            console.log('Unknown message type:', data.type);\n            break;\n        }\n      });\n      \n      ws.on('error', (error) => {\n        console.error('ResilientWebSocket error:', error);\n      });\n      \n      // \n      ws.connect().catch(error => {\n        console.error('Failed to connect ResilientWebSocket:', error);\n      });\n      \n      return ws;\n    } catch (err) {\n      console.error('Failed to create ResilientWebSocket:', err);\n      return null;\n    }\n  }, [user, sessionId, onNewMessage, onTyping, onSessionUpdate]);\n\n  // Ping/pong    ResilientWebSocket\n\n  //   \n  useEffect(() => {\n    if (user && sessionId !== undefined) {\n      createWebSocket();\n    }\n\n    return () => {\n      //   \n      if (typingTimeoutRef.current) {\n        clearTimeout(typingTimeoutRef.current);\n      }\n      if (websocketRef.current) {\n        websocketRef.current.disconnect();\n        websocketRef.current = null;\n      }\n    };\n  }, [user, sessionId, createWebSocket]);\n\n  //    \n  const sendMessage = useCallback((message) => {\n    if (websocketRef.current) {\n      //  sessionId   \n      const payload = {\n        ...message,\n        session_id: sessionId\n      };\n      return websocketRef.current.send(payload);\n    }\n    console.warn('ResilientWebSocket not available, message queued');\n    return false;\n  }, [sessionId]);\n\n  //        debounce\n  const sendTyping = useCallback((isTyping) => {\n    if (isTypingRef.current === isTyping) return;\n\n    //      \n    if (isTyping) {\n      isTypingRef.current = true;\n      sendMessage({ type: 'typing', is_typing: true });\n\n      // -  3 \n      clearTimeout(typingTimeoutRef.current);\n      typingTimeoutRef.current = setTimeout(() => {\n        sendTyping(false);\n      }, 3000);\n    } else {\n      //     ,      \n      clearTimeout(typingTimeoutRef.current);\n      typingTimeoutRef.current = setTimeout(() => {\n        isTypingRef.current = false;\n        sendMessage({ type: 'typing', is_typing: false });\n      }, 300);\n    }\n  }, [sendMessage]);\n\n  //      \n  const joinSession = useCallback((newSessionId) => {\n    sendMessage({\n      type: 'join_session',\n      session_id: newSessionId\n    });\n  }, [sendMessage]);\n\n  //    -\n  const sendChatMessage = useCallback((content) => {\n    return sendMessage({\n      type: 'new_message',\n      content: content\n    });\n  }, [sendMessage]);\n\n  //    \n  const stopGeneration = useCallback(() => {\n    return sendMessage({\n      type: 'stop_generation'\n    });\n  }, [sendMessage]);\n\n  //    \n  const connect = useCallback(() => {\n    if (websocketRef.current && websocketRef.current.isConnected) {\n      console.log('ResilientWebSocket already connected');\n      return;\n    }\n    createWebSocket();\n  }, [createWebSocket]);\n\n  //   \n  const disconnect = useCallback(() => {\n    if (websocketRef.current) {\n      websocketRef.current.disconnect();\n      websocketRef.current = null;\n    }\n    setIsConnected(false);\n    setConnectionState('disconnected');\n  }, []);\n\n  //    \n  const forceReconnect = useCallback(() => {\n    if (websocketRef.current) {\n      websocketRef.current.reconnect();\n    } else {\n      createWebSocket();\n    }\n  }, [createWebSocket]);\n\n  return {\n    isConnected,\n    connectionState,\n    websocket: websocketRef.current,\n    sendTyping,\n    joinSession,\n    sendChatMessage,\n    stopGeneration,\n    connect,\n    disconnect,\n    forceReconnect\n  };\n};\n","import { useCallback } from 'react';\n\n/**\n *        \n *   API     \n */\nexport const useStatusNotifications = () => {\n  const showError = useCallback((error, options = {}) => {\n    if (window.statusNotifications) {\n      return window.statusNotifications.showError(error, options);\n    }\n    console.error('Status notifications not available:', error);\n  }, []);\n\n  const showSuccess = useCallback((message, options = {}) => {\n    if (window.statusNotifications) {\n      return window.statusNotifications.showSuccess(message, options);\n    }\n    console.log('Success:', message);\n  }, []);\n\n  const showInfo = useCallback((message, options = {}) => {\n    if (window.statusNotifications) {\n      return window.statusNotifications.showInfo(message, options);\n    }\n    console.info('Info:', message);\n  }, []);\n\n  const showModelUnavailable = useCallback(() => {\n    if (window.statusNotifications) {\n      return window.statusNotifications.showModelUnavailable();\n    }\n    console.error('Model unavailable');\n  }, []);\n\n  const removeNotification = useCallback((id) => {\n    if (window.statusNotifications) {\n      return window.statusNotifications.removeNotification(id);\n    }\n  }, []);\n\n  //     \n  const showConnectionError = useCallback((error) => {\n    return showError(error, {\n      title: ' ',\n      autoHide: false,\n      actions: [\n        {\n          label: '',\n          action: () => window.location.reload(),\n          primary: true\n        }\n      ]\n    });\n  }, [showError]);\n\n  const showAuthError = useCallback(() => {\n    return showError('  ', {\n      title: ' ',\n      autoHide: false,\n      actions: [\n        {\n          label: '',\n          action: () => window.location.href = '/login',\n          primary: true\n        }\n      ]\n    });\n  }, [showError]);\n\n  const showGenerationStopped = useCallback(() => {\n    return showInfo('   ', {\n      duration: 3000\n    });\n  }, [showInfo]);\n\n  const showGenerationTimeout = useCallback(() => {\n    return showError('   ', {\n      title: ' ',\n      autoHide: false,\n      actions: [\n        {\n          label: ' ',\n          action: () => window.location.reload(),\n          primary: true\n        }\n      ]\n    });\n  }, [showError]);\n\n  return {\n    showError,\n    showSuccess,\n    showInfo,\n    showModelUnavailable,\n    removeNotification,\n    //  \n    showConnectionError,\n    showAuthError,\n    showGenerationStopped,\n    showGenerationTimeout\n  };\n};\n\nexport default useStatusNotifications;","import React, { useState, useRef, useEffect } from 'react';\nimport { Mic, MicOff, Play, Pause, Square, Trash2, Send, Volume2, VolumeX } from 'lucide-react';\nimport { useTheme } from '../contexts/ThemeContext';\n\nconst VoiceRecorder = ({ onSendVoiceMessage, onCancel, maxDuration = 300 }) => {\n  const [isRecording, setIsRecording] = useState(false);\n  const [isPaused, setIsPaused] = useState(false);\n  const [recordingTime, setRecordingTime] = useState(0);\n  const [audioBlob, setAudioBlob] = useState(null);\n  const [audioUrl, setAudioUrl] = useState(null);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [volume, setVolume] = useState(1);\n  const [isMuted, setIsMuted] = useState(false);\n  const [error, setError] = useState(null);\n  \n  const mediaRecorderRef = useRef(null);\n  const audioRef = useRef(null);\n  const streamRef = useRef(null);\n  const timerRef = useRef(null);\n  const chunksRef = useRef([]);\n  \n  const { isDark } = useTheme();\n\n  //    \n  useEffect(() => {\n    return () => {\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach(track => track.stop());\n      }\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n      }\n      if (audioUrl) {\n        URL.revokeObjectURL(audioUrl);\n      }\n    };\n  }, [audioUrl]);\n\n  //   \n  const checkBrowserSupport = () => {\n    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n      setError('     ');\n      return false;\n    }\n    return true;\n  };\n\n  //  \n  const startRecording = async () => {\n    if (!checkBrowserSupport()) return;\n\n    try {\n      setError(null);\n      const stream = await navigator.mediaDevices.getUserMedia({ \n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          sampleRate: 44100\n        } \n      });\n      \n      streamRef.current = stream;\n      \n      const mediaRecorder = new MediaRecorder(stream, {\n        mimeType: 'audio/webm;codecs=opus'\n      });\n      \n      mediaRecorderRef.current = mediaRecorder;\n      chunksRef.current = [];\n      \n      mediaRecorder.ondataavailable = (event) => {\n        if (event.data.size > 0) {\n          chunksRef.current.push(event.data);\n        }\n      };\n      \n      mediaRecorder.onstop = () => {\n        const blob = new Blob(chunksRef.current, { type: 'audio/webm' });\n        setAudioBlob(blob);\n        const url = URL.createObjectURL(blob);\n        setAudioUrl(url);\n        \n        //   \n        stream.getTracks().forEach(track => track.stop());\n      };\n      \n      mediaRecorder.start(100); //   100\n      setIsRecording(true);\n      setRecordingTime(0);\n      \n      //  \n      timerRef.current = setInterval(() => {\n        setRecordingTime(prev => {\n          if (prev >= maxDuration) {\n            stopRecording();\n            return maxDuration;\n          }\n          return prev + 1;\n        });\n      }, 1000);\n      \n    } catch (err) {\n      console.error('Error starting recording:', err);\n      setError('   .   .');\n    }\n  };\n\n  // / \n  const togglePause = () => {\n    if (!mediaRecorderRef.current) return;\n    \n    if (isPaused) {\n      mediaRecorderRef.current.resume();\n      setIsPaused(false);\n      //  \n      timerRef.current = setInterval(() => {\n        setRecordingTime(prev => {\n          if (prev >= maxDuration) {\n            stopRecording();\n            return maxDuration;\n          }\n          return prev + 1;\n        });\n      }, 1000);\n    } else {\n      mediaRecorderRef.current.pause();\n      setIsPaused(true);\n      clearInterval(timerRef.current);\n    }\n  };\n\n  //  \n  const stopRecording = () => {\n    if (mediaRecorderRef.current && isRecording) {\n      mediaRecorderRef.current.stop();\n      setIsRecording(false);\n      setIsPaused(false);\n      clearInterval(timerRef.current);\n    }\n  };\n\n  //  \n  const togglePlayback = () => {\n    if (!audioRef.current || !audioUrl) return;\n    \n    if (isPlaying) {\n      audioRef.current.pause();\n      setIsPlaying(false);\n    } else {\n      audioRef.current.play();\n      setIsPlaying(true);\n    }\n  };\n\n  //  \n  useEffect(() => {\n    const audio = audioRef.current;\n    if (!audio) return;\n\n    const handleEnded = () => setIsPlaying(false);\n    const handlePlay = () => setIsPlaying(true);\n    const handlePause = () => setIsPlaying(false);\n\n    audio.addEventListener('ended', handleEnded);\n    audio.addEventListener('play', handlePlay);\n    audio.addEventListener('pause', handlePause);\n\n    return () => {\n      audio.removeEventListener('ended', handleEnded);\n      audio.removeEventListener('play', handlePlay);\n      audio.removeEventListener('pause', handlePause);\n    };\n  }, [audioUrl]);\n\n  //   \n  const sendVoiceMessage = () => {\n    if (audioBlob && onSendVoiceMessage) {\n      onSendVoiceMessage(audioBlob, recordingTime);\n      //  \n      setAudioBlob(null);\n      setAudioUrl(null);\n      setRecordingTime(0);\n      if (audioUrl) {\n        URL.revokeObjectURL(audioUrl);\n      }\n    }\n  };\n\n  //  \n  const cancelRecording = () => {\n    stopRecording();\n    setAudioBlob(null);\n    setAudioUrl(null);\n    setRecordingTime(0);\n    if (audioUrl) {\n      URL.revokeObjectURL(audioUrl);\n    }\n    if (onCancel) {\n      onCancel();\n    }\n  };\n\n  //  \n  const formatTime = (seconds) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  return (\n    <div className={`p-4 ${isDark ? 'bg-gray-800' : 'bg-white'} rounded-lg border border-gray-200 dark:border-gray-700 shadow-lg`}>\n      {error && (\n        <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg\">\n          <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n        </div>\n      )}\n\n      {/*     */}\n      {audioUrl && (\n        <audio\n          ref={audioRef}\n          src={audioUrl}\n          volume={isMuted ? 0 : volume}\n          onVolumeChange={(e) => setVolume(e.target.volume)}\n        />\n      )}\n\n      {/*   */}\n      {isRecording && (\n        <div className=\"mb-4 flex items-center justify-center space-x-2\">\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-3 h-3 bg-red-500 rounded-full animate-pulse\"></div>\n            <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n              {isPaused ? '' : ''}\n            </span>\n          </div>\n          <div className=\"text-lg font-mono text-gray-900 dark:text-gray-100\">\n            {formatTime(recordingTime)}\n          </div>\n        </div>\n      )}\n\n      {/*   */}\n      {isRecording && (\n        <div className=\"mb-4 flex items-center justify-center space-x-1\">\n          {[...Array(20)].map((_, i) => (\n            <div\n              key={i}\n              className={`w-1 bg-primary-500 rounded-full animate-pulse`}\n              style={{\n                height: `${Math.random() * 20 + 10}px`,\n                animationDelay: `${i * 0.1}s`\n              }}\n            />\n          ))}\n        </div>\n      )}\n\n      {/*   */}\n      <div className=\"flex items-center justify-center space-x-4\">\n        {!isRecording && !audioBlob && (\n          <button\n            onClick={startRecording}\n            className=\"p-3 bg-red-500 hover:bg-red-600 text-white rounded-full transition-colors duration-200 shadow-lg\"\n            title=\" \"\n          >\n            <Mic className=\"h-6 w-6\" />\n          </button>\n        )}\n\n        {isRecording && (\n          <>\n            <button\n              onClick={togglePause}\n              className=\"p-3 bg-yellow-500 hover:bg-yellow-600 text-white rounded-full transition-colors duration-200\"\n              title={isPaused ? ' ' : ''}\n            >\n              {isPaused ? <Play className=\"h-6 w-6\" /> : <Pause className=\"h-6 w-6\" />}\n            </button>\n            \n            <button\n              onClick={stopRecording}\n              className=\"p-3 bg-gray-500 hover:bg-gray-600 text-white rounded-full transition-colors duration-200\"\n              title=\" \"\n            >\n              <Square className=\"h-6 w-6\" />\n            </button>\n          </>\n        )}\n\n        {audioBlob && (\n          <>\n            <button\n              onClick={togglePlayback}\n              className=\"p-3 bg-blue-500 hover:bg-blue-600 text-white rounded-full transition-colors duration-200\"\n              title={isPlaying ? '' : ''}\n            >\n              {isPlaying ? <Pause className=\"h-6 w-6\" /> : <Play className=\"h-6 w-6\" />}\n            </button>\n            \n            <button\n              onClick={() => setIsMuted(!isMuted)}\n              className=\"p-3 bg-gray-500 hover:bg-gray-600 text-white rounded-full transition-colors duration-200\"\n              title={isMuted ? ' ' : ' '}\n            >\n              {isMuted ? <VolumeX className=\"h-6 w-6\" /> : <Volume2 className=\"h-6 w-6\" />}\n            </button>\n            \n            <button\n              onClick={sendVoiceMessage}\n              className=\"p-3 bg-green-500 hover:bg-green-600 text-white rounded-full transition-colors duration-200\"\n              title=\"  \"\n            >\n              <Send className=\"h-6 w-6\" />\n            </button>\n            \n            <button\n              onClick={cancelRecording}\n              className=\"p-3 bg-red-500 hover:bg-red-600 text-white rounded-full transition-colors duration-200\"\n              title=\" \"\n            >\n              <Trash2 className=\"h-6 w-6\" />\n            </button>\n          </>\n        )}\n      </div>\n\n      {/*    */}\n      {audioBlob && (\n        <div className=\"mt-4 text-center\">\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n            : {formatTime(recordingTime)} | \n            : {(audioBlob.size / 1024).toFixed(1)} KB\n          </p>\n        </div>\n      )}\n\n      {/* -    */}\n      {isRecording && (\n        <div className=\"mt-4\">\n          <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2\">\n            <div\n              className=\"bg-primary-500 h-2 rounded-full transition-all duration-1000\"\n              style={{ width: `${(recordingTime / maxDuration) * 100}%` }}\n            />\n          </div>\n          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1 text-center\">\n            : {formatTime(maxDuration)}\n          </p>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default VoiceRecorder;\n","import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { \n  MessageSquare, \n  Plus, \n  Trash2, \n  Edit3, \n  Check, \n  X, \n  Calendar,\n  Clock,\n  ChevronLeft,\n  ChevronRight,\n  Search,\n  Eraser\n} from 'lucide-react';\nimport axios from 'axios';\nimport { getApiUrl } from '../config/api';\n\nconst ChatHistory = ({ \n  currentSessionId, \n  onSessionSelect, \n  onNewChat,\n  isCollapsed,\n  onToggleCollapse,\n  focusSearch = false,\n  hideHeader = false\n}) => {\n  const [sessions, setSessions] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [editingSession, setEditingSession] = useState(null);\n  const [editTitle, setEditTitle] = useState('');\n  const [showEmptyChats, setShowEmptyChats] = useState(false); //    \n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchResults, setSearchResults] = useState([]);\n  const [isSearching, setIsSearching] = useState(false);\n  const [sessionMessages, setSessionMessages] = useState({}); //    \n  const searchInputRef = React.useRef(null);\n\n  //   \n  const loadSessions = useCallback(async () => {\n    try {\n      setLoading(true);\n      //     include_empty\n      const response = await axios.get(getApiUrl('/chat/sessions'), {\n        params: { include_empty: showEmptyChats }\n      });\n      const sessionsData = response.data || [];\n      \n      //  :   ( updated_at  created_at)\n      const sortedSessions = sessionsData.sort((a, b) => {\n        const dateA = new Date(a.updated_at || a.created_at);\n        const dateB = new Date(b.updated_at || b.created_at);\n        return dateB - dateA; //  \n      });\n      \n      setSessions(sortedSessions);\n      setError(null);\n    } catch (err) {\n      console.error('Error loading sessions:', err);\n      setError('   ');\n    } finally {\n      setLoading(false);\n    }\n  }, [showEmptyChats]);\n\n  useEffect(() => {\n    loadSessions();\n  }, [loadSessions, showEmptyChats]); //    \n\n  //   \n  const handleNewChat = async () => {\n    try {\n      const response = await axios.post(getApiUrl('/chat/sessions'), {\n        title: `  ${new Date().toLocaleDateString('ru-RU')}`\n      });\n      \n      const newSession = response.data;\n      //       ( )\n      setSessions(prev => [newSession, ...prev]);\n      onNewChat(newSession.id);\n    } catch (err) {\n      console.error('Error creating new session:', err);\n      setError('   ');\n    }\n  };\n\n  //  \n  const handleDeleteSession = async (sessionId) => {\n    if (!window.confirm('  ?    .')) {\n      return;\n    }\n\n    try {\n      await axios.delete(getApiUrl(`/chat/sessions/${sessionId}`));\n      setSessions(prev => prev.filter(s => s.id !== sessionId));\n      \n      //    ,  \n      if (sessionId === currentSessionId) {\n        handleNewChat();\n      }\n    } catch (err) {\n      console.error('Error deleting session:', err);\n      setError('  ');\n    }\n  };\n\n  //   \n  const handleClearAllHistory = async () => {\n    if (sessions.length === 0) {\n      return;\n    }\n\n    const confirmMessage = ` ,      ?\\n\\n  ${sessions.length} ${sessions.length === 1 ? '' : sessions.length < 5 ? '' : ''}.\\n\\n   !`;\n    \n    if (!window.confirm(confirmMessage)) {\n      return;\n    }\n\n    try {\n      await axios.delete(getApiUrl('/chat/sessions/all'));\n      setSessions([]);\n      setSessionMessages({});\n      setSearchResults([]);\n      setSearchQuery('');\n      \n      //     \n      handleNewChat();\n    } catch (err) {\n      console.error('Error clearing all history:', err);\n      setError('  ');\n    }\n  };\n\n  //   \n  const startEditing = (session) => {\n    setEditingSession(session.id);\n    setEditTitle(session.title || ' ');\n  };\n\n  //   \n  const saveTitle = async (sessionId) => {\n    try {\n      await axios.put(getApiUrl(`/chat/sessions/${sessionId}`), {\n        title: editTitle.trim() || ' '\n      });\n      \n      setSessions(prev => prev.map(s => \n        s.id === sessionId \n          ? { ...s, title: editTitle.trim() || ' ' }\n          : s\n      ));\n      \n      setEditingSession(null);\n      setEditTitle('');\n    } catch (err) {\n      console.error('Error updating session title:', err);\n      setError('  ');\n    }\n  };\n\n  //  \n  const cancelEditing = () => {\n    setEditingSession(null);\n    setEditTitle('');\n  };\n\n  //  \n  const formatDate = (dateString) => {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffDays = Math.floor((now - date) / (1000 * 60 * 60 * 24));\n    \n    if (diffDays === 0) {\n      return date.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });\n    } else if (diffDays === 1) {\n      return '';\n    } else if (diffDays < 7) {\n      return `${diffDays} . `;\n    } else {\n      return date.toLocaleDateString('ru-RU', { day: '2-digit', month: '2-digit' });\n    }\n  };\n\n  //     \n  const truncateTitle = (title, maxLength = 25) => {\n    if (!title) return ' ';\n    return title.length > maxLength ? title.substring(0, maxLength) + '...' : title;\n  };\n\n  //   \n  const searchInHistory = useCallback(async (query) => {\n    if (!query.trim()) {\n      setSearchResults([]);\n      setIsSearching(false);\n      return;\n    }\n\n    setIsSearching(true);\n    const lowerQuery = query.toLowerCase().trim();\n    const results = [];\n\n    try {\n      //     \n      const titleMatches = sessions.filter(session => \n        session.title && session.title.toLowerCase().includes(lowerQuery)\n      );\n\n      for (const session of titleMatches) {\n        results.push({\n          sessionId: session.id,\n          sessionTitle: session.title,\n          matchType: 'title',\n          matchText: session.title\n        });\n      }\n\n      //      \n      for (const session of sessions) {\n        //      \n        if (titleMatches.find(s => s.id === session.id)) continue;\n\n        try {\n          //    ( )\n          let messages = sessionMessages[session.id];\n          if (!messages) {\n            const response = await axios.get(getApiUrl(`/chat/sessions/${session.id}/messages`));\n            messages = response.data || [];\n            setSessionMessages(prev => ({ ...prev, [session.id]: messages }));\n          }\n\n          //    \n          const messageMatches = messages.filter(msg => \n            msg.content && msg.content.toLowerCase().includes(lowerQuery)\n          );\n\n          if (messageMatches.length > 0) {\n            results.push({\n              sessionId: session.id,\n              sessionTitle: session.title,\n              matchType: 'message',\n              matchText: messageMatches[0].content.substring(0, 100),\n              matchCount: messageMatches.length\n            });\n          }\n        } catch (err) {\n          console.error(`Error loading messages for session ${session.id}:`, err);\n        }\n      }\n\n      setSearchResults(results);\n    } catch (err) {\n      console.error('Error searching history:', err);\n      setError('   ');\n    } finally {\n      setIsSearching(false);\n    }\n  }, [sessions, sessionMessages]);\n\n  //    \n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      searchInHistory(searchQuery);\n    }, 300); // Debounce 300ms\n\n    return () => clearTimeout(timeoutId);\n  }, [searchQuery, searchInHistory]);\n\n  //      \n  useEffect(() => {\n    if (focusSearch && !isCollapsed && searchInputRef.current) {\n      //      \n      const timeoutId = setTimeout(() => {\n        searchInputRef.current?.focus();\n        //     (  )\n        if (onToggleCollapse && typeof onToggleCollapse === 'function') {\n          //      \n        }\n      }, 300);\n      return () => clearTimeout(timeoutId);\n    }\n  }, [focusSearch, isCollapsed]);\n\n  //    \n  const filteredSessions = useMemo(() => {\n    if (!searchQuery.trim()) {\n      return sessions;\n    }\n\n    //    ,    \n    const matchedSessionIds = new Set(searchResults.map(r => r.sessionId));\n    return sessions.filter(s => matchedSessionIds.has(s.id));\n  }, [sessions, searchQuery, searchResults]);\n\n  if (loading) {\n    return (\n      <div className={`bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transition-all duration-300 ${\n        isCollapsed ? 'w-16' : 'w-80'\n      }`}>\n        <div className=\"p-4 flex items-center justify-center\">\n          <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`h-full bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transition-all duration-300 flex flex-col ${\n      isCollapsed ? 'w-16' : 'w-80'\n    }`}>\n      {/*  */}\n      {!hideHeader && (\n        <div className=\"p-4 border-b border-gray-200 dark:border-gray-700\">\n          <div className=\"flex items-center justify-between mb-4\">\n            {!isCollapsed && (\n              <h2 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">\n                 \n              </h2>\n            )}\n            \n            <button\n              onClick={(e) => {\n                e.preventDefault();\n                e.stopPropagation();\n                if (onToggleCollapse && typeof onToggleCollapse === 'function') {\n                  onToggleCollapse();\n                }\n              }}\n              className=\"p-2 min-w-[44px] min-h-[44px] text-gray-600 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-all duration-200 flex items-center justify-center touch-manipulation\"\n              title={isCollapsed ? \"\" : \"\"}\n              aria-label={isCollapsed ? \" \" : \" \"}\n              type=\"button\"\n            >\n              {isCollapsed ? <ChevronRight className=\"h-5 w-5\" /> : <ChevronLeft className=\"h-5 w-5\" />}\n            </button>\n          </div>\n        \n          {/*    \" \" */}\n          <button\n            onClick={handleNewChat}\n            className={`w-full btn-glass-primary font-semibold rounded-xl transition-all duration-300 ${\n              isCollapsed ? 'p-3' : 'py-3 px-4'\n            }`}\n          >\n            <div className=\"flex items-center justify-center space-x-2\">\n              <Plus className={`${isCollapsed ? 'h-5 w-5' : 'h-5 w-5'}`} />\n              {!isCollapsed && <span> </span>}\n            </div>\n          </button>\n        </div>\n      )}\n\n      {/*   */}\n      <div className=\"flex-1 overflow-y-auto overflow-x-hidden min-h-0\">\n        {error && (\n          <div className=\"p-4\">\n            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3 text-sm text-red-600 dark:text-red-400\">\n              {error}\n            </div>\n          </div>\n        )}\n\n        {sessions.length === 0 && !loading && !error ? (\n          <div className=\"p-4 text-center\">\n            <MessageSquare className=\"h-12 w-12 text-gray-400 dark:text-gray-500 mx-auto mb-3\" />\n            {!isCollapsed && (\n              <>\n                <p className=\"text-gray-600 dark:text-gray-400 text-sm mb-3\">\n                  {showEmptyChats ? \"    \" : \"   \"}\n                </p>\n                <button\n                  onClick={handleNewChat}\n                  className=\"btn-glass-primary text-sm px-4 py-2\"\n                >\n                    \n                </button>\n              </>\n            )}\n          </div>\n        ) : (\n          <div className=\"p-2 space-y-1\">\n            {filteredSessions.map((session) => {\n              //       \n              const searchMatch = searchResults.find(r => r.sessionId === session.id);\n              \n              return (\n              <div\n                key={session.id}\n                className={`group relative rounded-lg transition-all duration-200 ${\n                  session.id === currentSessionId\n                    ? 'bg-primary-100 dark:bg-primary-900/50 border border-primary-200 dark:border-primary-800'\n                    : 'hover:bg-gray-100 dark:hover:bg-gray-700 border border-transparent'\n                }`}\n              >\n                <button\n                  onClick={(e) => {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    console.log('  :', session.id, ' :', currentSessionId);\n                    if (onSessionSelect && typeof onSessionSelect === 'function') {\n                      onSessionSelect(session.id);\n                    } else {\n                      console.error('onSessionSelect   :', onSessionSelect);\n                    }\n                  }}\n                  className={`w-full p-3 text-left transition-all duration-200 ${\n                    isCollapsed ? 'px-2' : ''\n                  }`}\n                  title={isCollapsed ? session.title || ' ' : ''}\n                >\n                  <div className=\"flex items-center space-x-3\">\n                    <MessageSquare className={`flex-shrink-0 ${\n                      session.id === currentSessionId\n                        ? 'text-primary-600 dark:text-primary-400'\n                        : 'text-gray-500 dark:text-gray-400'\n                    } ${isCollapsed ? 'h-5 w-5' : 'h-4 w-4'}`} />\n                    \n                    {!isCollapsed && (\n                      <div className=\"flex-1 min-w-0\">\n                        {editingSession === session.id ? (\n                          <div className=\"flex items-center space-x-2\">\n                            <input\n                              type=\"text\"\n                              value={editTitle}\n                              onChange={(e) => setEditTitle(e.target.value)}\n                              onKeyPress={(e) => {\n                                if (e.key === 'Enter') saveTitle(session.id);\n                                if (e.key === 'Escape') cancelEditing();\n                              }}\n                              className=\"flex-1 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100\"\n                              autoFocus\n                            />\n                            <button\n                              onClick={() => saveTitle(session.id)}\n                              className=\"p-1 text-green-600 hover:text-green-700\"\n                            >\n                              <Check className=\"h-3 w-3\" />\n                            </button>\n                            <button\n                              onClick={cancelEditing}\n                              className=\"p-1 text-red-600 hover:text-red-700\"\n                            >\n                              <X className=\"h-3 w-3\" />\n                            </button>\n                          </div>\n                        ) : (\n                          <>\n                            <p className={`text-sm font-medium truncate ${\n                              session.id === currentSessionId\n                                ? 'text-primary-800 dark:text-primary-200'\n                                : 'text-gray-900 dark:text-gray-100'\n                            }`}>\n                              {truncateTitle(session.title)}\n                            </p>\n                            \n                            {/*       */}\n                            {searchMatch ? (\n                              <div className=\"mt-1\">\n                                <p className=\"text-xs text-primary-600 dark:text-primary-400 font-medium\">\n                                  {searchMatch.matchType === 'title' ? '  ' : \n                                   ` ${searchMatch.matchCount || 1} ${searchMatch.matchCount === 1 ? '' : ''}`}\n                                </p>\n                                {searchMatch.matchType === 'message' && (\n                                  <p className=\"text-xs text-gray-500 dark:text-gray-400 truncate mt-0.5\">\n                                    {searchMatch.matchText}...\n                                  </p>\n                                )}\n                              </div>\n                            ) : session.last_message_preview && (\n                              <p className=\"text-xs text-gray-500 dark:text-gray-400 truncate mt-1\">\n                                {session.last_message_preview}\n                              </p>\n                            )}\n                            \n                            <p className=\"text-xs text-gray-400 dark:text-gray-500 flex items-center mt-1\">\n                              <Clock className=\"h-3 w-3 mr-1\" />\n                              {formatDate(session.last_message_time || session.updated_at || session.created_at)}\n                            </p>\n                          </>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                </button>\n\n                {/*    */}\n                {!isCollapsed && editingSession !== session.id && (\n                  <div className=\"absolute right-2 top-1/2 transform -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-200\">\n                    <div className=\"flex items-center space-x-1\">\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          startEditing(session);\n                        }}\n                        className=\"p-1.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-white dark:hover:bg-gray-800 rounded transition-all duration-200\"\n                        title=\"\"\n                      >\n                        <Edit3 className=\"h-3 w-3\" />\n                      </button>\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          handleDeleteSession(session.id);\n                        }}\n                        className=\"p-1.5 text-gray-400 hover:text-red-600 hover:bg-white dark:hover:bg-gray-800 rounded transition-all duration-200\"\n                        title=\"\"\n                      >\n                        <Trash2 className=\"h-3 w-3\" />\n                      </button>\n                    </div>\n                  </div>\n                )}\n              </div>\n            );\n            })}\n          </div>\n        )}\n      </div>\n\n      {/*    -  ,   */}\n      {!isCollapsed && (\n        <div className=\"flex-shrink-0 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 overflow-visible\">\n          {/*   -   ,   */}\n          <div className=\"p-3\">\n            <div className=\"relative mb-2\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 dark:text-gray-500 z-10 pointer-events-none\" />\n              <input\n                ref={searchInputRef}\n                type=\"text\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                onFocus={() => {\n                  //         \n                  if (focusSearch) {\n                    //         \n                  }\n                }}\n                placeholder=\"  ...\"\n                className=\"w-full pl-10 pr-10 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400\"\n                style={{ display: 'block' }}\n              />\n              {searchQuery && (\n                <button\n                  onClick={() => setSearchQuery('')}\n                  className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 z-10\"\n                >\n                  <X className=\"h-4 w-4\" />\n                </button>\n              )}\n            </div>\n\n            {/*   */}\n            {isSearching && (\n              <div className=\"text-xs text-gray-500 dark:text-gray-400 text-center\">\n                ...\n              </div>\n            )}\n\n            {searchQuery.trim() && !isSearching && (\n              <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                {searchResults.length > 0 ? (\n                  `: ${searchResults.length} ${searchResults.length === 1 ? '' : ''}`\n                ) : (\n                  '  '\n                )}\n              </div>\n            )}\n          </div>\n\n          {/*      */}\n          <div className=\"px-3 pb-3 space-y-2 border-t border-gray-200 dark:border-gray-700 pt-3\">\n            <label className=\"flex items-center justify-between text-xs\">\n              <span className=\"text-gray-600 dark:text-gray-400\">  </span>\n              <button\n                onClick={() => setShowEmptyChats(!showEmptyChats)}\n                className={`relative inline-flex h-4 w-7 items-center rounded-full transition-colors duration-200 ${\n                  showEmptyChats \n                    ? 'bg-primary-600' \n                    : 'bg-gray-300 dark:bg-gray-600'\n                }`}\n              >\n                <span\n                  className={`inline-block h-3 w-3 transform rounded-full bg-white transition-transform duration-200 ${\n                    showEmptyChats ? 'translate-x-3.5' : 'translate-x-0.5'\n                  }`}\n                />\n              </button>\n            </label>\n            \n            <div className=\"text-xs text-gray-500 dark:text-gray-400 flex items-center justify-between\">\n              <span> : {sessions.length}</span>\n              <span className=\"flex items-center\">\n                <Calendar className=\"h-3 w-3 mr-1\" />\n                \n              </span>\n            </div>\n            \n            {/*  \" \" */}\n            {sessions.length > 0 && (\n              <button\n                onClick={(e) => {\n                  e.preventDefault();\n                  e.stopPropagation();\n                  handleClearAllHistory();\n                }}\n                className=\"w-full btn-glass-danger font-semibold rounded-xl transition-all duration-300 py-2.5 px-4 flex items-center justify-center space-x-2 mt-3\"\n                title=\"   \"\n                aria-label=\"   \"\n                type=\"button\"\n              >\n                <Eraser className=\"h-4 w-4\" />\n                <span> </span>\n              </button>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ChatHistory;\n","import React, { useState } from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport remarkGfm from 'remark-gfm';\nimport { \n  CheckCircle, \n  AlertTriangle, \n  FileText, \n  ExternalLink, \n  ChevronDown, \n  ChevronUp,\n  Shield,\n  Lightbulb,\n  Clock,\n  Target\n} from 'lucide-react';\n\nconst EnhancedResponse = ({ message, enhancements = {} }) => {\n  const [showDetails, setShowDetails] = useState(false);\n  const [showSources, setShowSources] = useState(false);\n  const [showWarnings, setShowWarnings] = useState(false);\n\n  //   undefined message\n  if (!message) {\n    console.warn('EnhancedResponse: message is undefined');\n    return (\n      <div className=\"text-gray-500 italic\">\n         \n      </div>\n    );\n  }\n\n  if (!message.content || typeof message.content !== 'string') {\n    console.warn('EnhancedResponse: message.content is undefined or not a string', message);\n    return (\n      <div className=\"text-gray-500 italic\">\n          \n      </div>\n    );\n  }\n\n  //   \n  const content = message.content.trim();\n  if (!content) {\n    return (\n      <div className=\"text-gray-500 italic\">\n         \n      </div>\n    );\n  }\n\n  //    enhancements ( message   )\n  const messageEnhancements = message.enhancements || enhancements || {};\n  const factChecking = messageEnhancements.fact_checking || {};\n  const explainability = messageEnhancements.explainability || {};\n  \n  //   - ,     \n  const rawQuality = messageEnhancements.overall_quality;\n  const overallQuality = rawQuality !== undefined && rawQuality !== null ? rawQuality : null;\n  \n  // ,     \n  //    :\n  // -    (null/undefined)\n  // -     0.5 (   )\n  //       0.5\n  const hasQualityRating = overallQuality !== null && overallQuality !== 0.5;\n\n  //   \n  const getQualityLevel = (quality) => {\n    if (quality >= 0.8) return { level: 'high', color: 'text-green-600 dark:text-green-400', bg: 'bg-green-100 dark:bg-green-900/30' };\n    if (quality >= 0.6) return { level: 'medium', color: 'text-yellow-600 dark:text-yellow-400', bg: 'bg-yellow-100 dark:bg-yellow-900/30' };\n    return { level: 'low', color: 'text-red-600 dark:text-red-400', bg: 'bg-red-100 dark:bg-red-900/30' };\n  };\n\n  const qualityInfo = overallQuality !== null ? getQualityLevel(overallQuality) : null;\n\n  //   -\n  const formatMetric = (value) => {\n    if (typeof value === 'number') {\n      return `${(value * 100).toFixed(1)}%`;\n    }\n    return value || 'N/A';\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      {/*      markdown */}\n      <div className=\"markdown-content max-w-none\">\n        <ReactMarkdown\n          remarkPlugins={[remarkGfm]}\n          components={{\n            //     \n            h1: ({node, ...props}) => <h1 className=\"text-2xl font-bold mt-4 mb-2 text-gray-900 dark:text-gray-100\" {...props} />,\n            h2: ({node, ...props}) => <h2 className=\"text-xl font-semibold mt-3 mb-2 text-gray-900 dark:text-gray-100\" {...props} />,\n            h3: ({node, ...props}) => <h3 className=\"text-lg font-semibold mt-3 mb-2 text-gray-900 dark:text-gray-100\" {...props} />,\n            h4: ({node, ...props}) => <h4 className=\"text-base font-semibold mt-2 mb-1 text-gray-900 dark:text-gray-100\" {...props} />,\n            p: ({node, ...props}) => <p className=\"mb-2 text-gray-900 dark:text-gray-100 leading-relaxed\" {...props} />,\n            strong: ({node, ...props}) => <strong className=\"font-semibold text-gray-900 dark:text-gray-100\" {...props} />,\n            em: ({node, ...props}) => <em className=\"italic\" {...props} />,\n            ul: ({node, ...props}) => <ul className=\"list-disc list-inside mb-2 space-y-1 text-gray-900 dark:text-gray-100\" {...props} />,\n            ol: ({node, ...props}) => <ol className=\"list-decimal list-inside mb-2 space-y-1 text-gray-900 dark:text-gray-100\" {...props} />,\n            li: ({node, ...props}) => <li className=\"ml-2\" {...props} />,\n            code: ({node, inline, ...props}) => \n              inline ? (\n                <code className=\"bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded text-sm font-mono text-gray-900 dark:text-gray-100\" {...props} />\n              ) : (\n                <code className=\"block bg-gray-100 dark:bg-gray-800 p-3 rounded-lg text-sm font-mono text-gray-900 dark:text-gray-100 overflow-x-auto mb-2\" {...props} />\n              ),\n            blockquote: ({node, ...props}) => (\n              <blockquote className=\"border-l-4 border-blue-500 dark:border-blue-400 pl-4 italic my-2 text-gray-700 dark:text-gray-300\" {...props} />\n            ),\n            a: ({node, ...props}) => (\n              <a className=\"text-blue-600 dark:text-blue-400 hover:underline\" target=\"_blank\" rel=\"noopener noreferrer\" {...props} />\n            ),\n            hr: ({node, ...props}) => <hr className=\"my-4 border-gray-300 dark:border-gray-600\" {...props} />,\n            table: ({node, ...props}) => (\n              <div className=\"overflow-x-auto my-2\">\n                <table className=\"min-w-full border-collapse border border-gray-300 dark:border-gray-600\" {...props} />\n              </div>\n            ),\n            th: ({node, ...props}) => (\n              <th className=\"border border-gray-300 dark:border-gray-600 px-3 py-2 bg-gray-100 dark:bg-gray-800 font-semibold text-left text-gray-900 dark:text-gray-100\" {...props} />\n            ),\n            td: ({node, ...props}) => (\n              <td className=\"border border-gray-300 dark:border-gray-600 px-3 py-2 text-gray-900 dark:text-gray-100\" {...props} />\n            ),\n          }}\n        >\n          {content}\n        </ReactMarkdown>\n      </div>\n\n      {/*    -        */}\n      {hasQualityRating && qualityInfo && (\n        <div className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium border ${qualityInfo.bg} ${qualityInfo.color} neon-glow-purple`}>\n          <Shield className=\"w-4 h-4 mr-2\" />\n          : {qualityInfo.level === 'high' ? '' : qualityInfo.level === 'medium' ? '' : ''}\n        </div>\n      )}\n\n      {/*     */}\n      <div className=\"flex flex-wrap gap-2\">\n        {Object.keys(factChecking).length > 0 && (\n          <button\n            onClick={() => setShowDetails(!showDetails)}\n            className=\"flex items-center px-3 py-1 bg-blue-100 text-blue-700 rounded-lg text-sm hover:bg-blue-200 transition-colors\"\n          >\n            <Target className=\"w-4 h-4 mr-2\" />\n            -\n            {showDetails ? <ChevronUp className=\"w-4 h-4 ml-1\" /> : <ChevronDown className=\"w-4 h-4 ml-1\" />}\n          </button>\n        )}\n\n        {explainability.sources && explainability.sources.length > 0 && (\n          <button\n            onClick={() => setShowSources(!showSources)}\n            className=\"flex items-center px-3 py-1 bg-green-100 text-green-700 rounded-lg text-sm hover:bg-green-200 transition-colors\"\n          >\n            <FileText className=\"w-4 h-4 mr-2\" />\n             ({explainability.sources.length})\n            {showSources ? <ChevronUp className=\"w-4 h-4 ml-1\" /> : <ChevronDown className=\"w-4 h-4 ml-1\" />}\n          </button>\n        )}\n\n        {explainability.warnings && explainability.warnings.length > 0 && (\n          <button\n            onClick={() => setShowWarnings(!showWarnings)}\n            className=\"flex items-center px-3 py-1 bg-yellow-100 text-yellow-700 rounded-lg text-sm hover:bg-yellow-200 transition-colors\"\n          >\n            <AlertTriangle className=\"w-4 h-4 mr-2\" />\n             ({explainability.warnings.length})\n            {showWarnings ? <ChevronUp className=\"w-4 h-4 ml-1\" /> : <ChevronDown className=\"w-4 h-4 ml-1\" />}\n          </button>\n        )}\n      </div>\n\n      {/*  - */}\n      {showDetails && Object.keys(factChecking).length > 0 && (\n        <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\n          <h4 className=\"font-semibold text-blue-900 dark:text-blue-100 mb-3 flex items-center\">\n            <Target className=\"w-5 h-5 mr-2\" />\n             -\n          </h4>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <span className=\"text-sm text-gray-600 dark:text-gray-400\"> :</span>\n                <span className={`font-medium ${factChecking.citation_recall >= 0.7 ? 'text-green-600' : 'text-red-600'}`}>\n                  {formatMetric(factChecking.citation_recall)}\n                </span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-sm text-gray-600 dark:text-gray-400\"> :</span>\n                <span className={`font-medium ${factChecking.support_coverage >= 0.5 ? 'text-green-600' : 'text-yellow-600'}`}>\n                  {formatMetric(factChecking.support_coverage)}\n                </span>\n              </div>\n            </div>\n            <div className=\"space-y-2\">\n              <div className=\"flex justify-between\">\n                <span className=\"text-sm text-gray-600 dark:text-gray-400\"> :</span>\n                <span className={`font-medium ${factChecking.hallucination_score <= 0.3 ? 'text-green-600' : 'text-red-600'}`}>\n                  {formatMetric(factChecking.hallucination_score)}\n                </span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"text-sm text-gray-600 dark:text-gray-400\"> :</span>\n                <span className={`font-medium ${factChecking.legal_consistency >= 0.8 ? 'text-green-600' : 'text-yellow-600'}`}>\n                  {formatMetric(factChecking.legal_consistency)}\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/*  */}\n      {showSources && explainability.sources && explainability.sources.length > 0 && (\n        <div className=\"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4\">\n          <h4 className=\"font-semibold text-green-900 dark:text-green-100 mb-3 flex items-center\">\n            <FileText className=\"w-5 h-5 mr-2\" />\n             \n          </h4>\n          <div className=\"space-y-3\">\n            {explainability.sources.map((source, index) => (\n              <div key={index} className=\"bg-white dark:bg-gray-800 rounded-lg p-3 border border-green-200 dark:border-green-700\">\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"font-medium text-gray-900 dark:text-gray-100\">\n                      {source.code} {source.article} {source.part} {source.item}\n                    </div>\n                    {source.edition && (\n                      <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n                        {source.edition}\n                      </div>\n                    )}\n                    <div className=\"text-sm text-gray-700 dark:text-gray-300 mt-2\">\n                      {source.excerpt}\n                    </div>\n                    {source.url && (\n                      <a\n                        href={source.url}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"inline-flex items-center text-sm text-blue-600 hover:text-blue-800 mt-2\"\n                      >\n                        <ExternalLink className=\"w-4 h-4 mr-1\" />\n                         \n                      </a>\n                    )}\n                  </div>\n                  {source.relevance_score && (\n                    <div className=\"text-xs text-gray-500 dark:text-gray-400 ml-2\">\n                      {Math.round(source.relevance_score * 100)}%\n                    </div>\n                  )}\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/*  */}\n      {showWarnings && explainability.warnings && explainability.warnings.length > 0 && (\n        <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4\">\n          <h4 className=\"font-semibold text-yellow-900 dark:text-yellow-100 mb-3 flex items-center\">\n            <AlertTriangle className=\"w-5 h-5 mr-2\" />\n             \n          </h4>\n          <div className=\"space-y-2\">\n            {explainability.warnings.map((warning, index) => (\n              <div key={index} className=\"flex items-start space-x-2 text-sm text-yellow-800 dark:text-yellow-200\">\n                <AlertTriangle className=\"w-4 h-4 mt-0.5 flex-shrink-0\" />\n                <span>{warning}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/*   */}\n      {explainability.user_actions && explainability.user_actions.length > 0 && (\n        <div className=\"bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg p-4\">\n          <h4 className=\"font-semibold text-purple-900 dark:text-purple-100 mb-3 flex items-center\">\n            <Lightbulb className=\"w-5 h-5 mr-2\" />\n            \n          </h4>\n          <div className=\"space-y-2\">\n            {explainability.user_actions.map((action, index) => (\n              <div key={index} className=\"flex items-start space-x-2 text-sm text-purple-800 dark:text-purple-200\">\n                <CheckCircle className=\"w-4 h-4 mt-0.5 flex-shrink-0\" />\n                <span>{action}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/*  ( ) */}\n      {explainability.arguments && explainability.arguments.length > 0 && (\n        <div className=\"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n          <h4 className=\"font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center\">\n            <FileText className=\"w-5 h-5 mr-2\" />\n            \n          </h4>\n          <div className=\"space-y-3\">\n            {explainability.arguments.map((argument, index) => (\n              <div key={index} className=\"bg-white dark:bg-gray-700 rounded-lg p-3\">\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"text-sm text-gray-700 dark:text-gray-300\">\n                      {argument.text}\n                    </div>\n                    {argument.confidence && (\n                      <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                        : {Math.round(argument.confidence * 100)}%\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/*   */}\n      {explainability.metadata && (\n        <div className=\"text-xs text-gray-500 dark:text-gray-400 flex items-center space-x-4\">\n          <div className=\"flex items-center\">\n            <Clock className=\"w-3 h-3 mr-1\" />\n            {explainability.metadata.created_at && \n              new Date(explainability.metadata.created_at).toLocaleString('ru-RU')\n            }\n          </div>\n          {explainability.metadata.sources_count && (\n            <div>\n              : {explainability.metadata.sources_count}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default EnhancedResponse;\n","import React, { useState } from 'react';\nimport axios from 'axios';\nimport { ThumbsUp, ThumbsDown } from 'lucide-react';\n\nconst FeedbackButtons = ({ messageId, onFeedbackSubmitted }) => {\n  const [feedback, setFeedback] = useState(null);\n  const [showReasonModal, setShowReasonModal] = useState(false);\n  const [selectedReason, setSelectedReason] = useState('');\n  const [comment, setComment] = useState('');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const reasons = [\n    { value: 'not_answered', label: '   ' },\n    { value: 'inaccurate', label: ' ' },\n    { value: 'hard_to_understand', label: ' ' },\n    { value: 'other', label: '' }\n  ];\n\n  const handlePositiveFeedback = async () => {\n    try {\n      setIsSubmitting(true);\n      const token = localStorage.getItem('token');\n      \n      await axios.post(\n        `${process.env.REACT_APP_API_URL}/api/v1/feedback/rate`,\n        {\n          message_id: messageId,\n          rating: 'positive'\n        },\n        {\n          headers: { Authorization: `Bearer ${token}` }\n        }\n      );\n      \n      setFeedback('positive');\n      if (onFeedbackSubmitted) onFeedbackSubmitted('positive');\n    } catch (error) {\n      console.error('Error submitting positive feedback:', error);\n      alert('  ');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleNegativeFeedback = () => {\n    setShowReasonModal(true);\n  };\n\n  const submitNegativeFeedback = async () => {\n    if (!selectedReason) {\n      alert(',  ');\n      return;\n    }\n\n    try {\n      setIsSubmitting(true);\n      const token = localStorage.getItem('token');\n      \n      await axios.post(\n        `${process.env.REACT_APP_API_URL}/api/v1/feedback/rate`,\n        {\n          message_id: messageId,\n          rating: 'negative',\n          reason: selectedReason,\n          comment: comment || undefined\n        },\n        {\n          headers: { Authorization: `Bearer ${token}` }\n        }\n      );\n      \n      setFeedback('negative');\n      setShowReasonModal(false);\n      if (onFeedbackSubmitted) onFeedbackSubmitted('negative');\n    } catch (error) {\n      console.error('Error submitting negative feedback:', error);\n      alert('  ');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  if (feedback) {\n    return (\n      <div className=\"flex items-center gap-2 text-sm text-gray-500\">\n        {feedback === 'positive' ? (\n          <>\n            <ThumbsUp className=\"w-4 h-4 text-green-500 fill-current\" />\n            <span>  !</span>\n          </>\n        ) : (\n          <>\n            <ThumbsDown className=\"w-4 h-4 text-red-500 fill-current\" />\n            <span>   !</span>\n          </>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <div className=\"flex items-center gap-2\">\n        <button\n          onClick={handlePositiveFeedback}\n          disabled={isSubmitting}\n          className=\"flex items-center gap-1 px-3 py-1.5 text-sm text-gray-600 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors disabled:opacity-50\"\n          title=\"\"\n        >\n          <ThumbsUp className=\"w-4 h-4\" />\n          <span></span>\n        </button>\n        \n        <button\n          onClick={handleNegativeFeedback}\n          disabled={isSubmitting}\n          className=\"flex items-center gap-1 px-3 py-1.5 text-sm text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50\"\n          title=\" \"\n        >\n          <ThumbsDown className=\"w-4 h-4\" />\n          <span> </span>\n        </button>\n      </div>\n\n      {/* Modal    */}\n      {showReasonModal && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 max-w-md w-full mx-4\">\n            <h3 className=\"text-lg font-semibold mb-4\">   ?</h3>\n            \n            <div className=\"space-y-2 mb-4\">\n              {reasons.map((reason) => (\n                <label key={reason.value} className=\"flex items-center gap-2 cursor-pointer\">\n                  <input\n                    type=\"radio\"\n                    name=\"reason\"\n                    value={reason.value}\n                    checked={selectedReason === reason.value}\n                    onChange={(e) => setSelectedReason(e.target.value)}\n                    className=\"w-4 h-4 text-blue-600\"\n                  />\n                  <span className=\"text-sm\">{reason.label}</span>\n                </label>\n              ))}\n            </div>\n\n            <textarea\n              value={comment}\n              onChange={(e) => setComment(e.target.value)}\n              placeholder=\"  ()\"\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n              rows=\"3\"\n            />\n\n            <div className=\"flex gap-2 mt-4\">\n              <button\n                onClick={submitNegativeFeedback}\n                disabled={isSubmitting || !selectedReason}\n                className=\"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {isSubmitting ? '...' : ''}\n              </button>\n              <button\n                onClick={() => {\n                  setShowReasonModal(false);\n                  setSelectedReason('');\n                  setComment('');\n                }}\n                disabled={isSubmitting}\n                className=\"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50\"\n              >\n                \n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default FeedbackButtons;\n","import React from 'react';\nimport { AlertCircle, RefreshCw, Wifi, WifiOff, Server, Clock, Zap } from 'lucide-react';\n\n/**\n *       \n *   6.1  \n */\nconst ErrorMessage = ({ \n  error, \n  onRetry, \n  onReconnect, \n  className = \"\",\n  showIcon = true,\n  variant = \"default\" // \"default\", \"inline\", \"toast\"\n}) => {\n  //      \n  const getErrorInfo = (error) => {\n    if (typeof error === 'string') {\n      return {\n        type: 'general',\n        title: '',\n        message: error,\n        icon: AlertCircle,\n        color: 'red',\n        actions: ['retry']\n      };\n    }\n\n    if (error?.code) {\n      switch (error.code) {\n        case 1008:\n          return {\n            type: 'auth',\n            title: ' ',\n            message: '  . ,    .',\n            icon: AlertCircle,\n            color: 'red',\n            actions: ['login']\n          };\n        \n        case 1006:\n          return {\n            type: 'connection',\n            title: ' ',\n            message: '   .   .',\n            icon: WifiOff,\n            color: 'orange',\n            actions: ['reconnect', 'retry']\n          };\n        \n        case 1011:\n          return {\n            type: 'server',\n            title: ' ',\n            message: '   .      .',\n            icon: Server,\n            color: 'red',\n            actions: ['retry', 'support']\n          };\n        \n        case 408:\n          return {\n            type: 'timeout',\n            title: '  ',\n            message: '     .   .',\n            icon: Clock,\n            color: 'orange',\n            actions: ['retry']\n          };\n        \n        case 503:\n          return {\n            type: 'overload',\n            title: ' ',\n            message: '  .     .',\n            icon: Zap,\n            color: 'yellow',\n            actions: ['retry']\n          };\n        \n        default:\n          return {\n            type: 'unknown',\n            title: ' ',\n            message: error.message || '  .   .',\n            icon: AlertCircle,\n            color: 'red',\n            actions: ['retry']\n          };\n      }\n    }\n\n    // HTTP \n    if (error?.response?.status) {\n      const status = error.response.status;\n      \n      if (status === 401) {\n        return {\n          type: 'auth',\n          title: ' ',\n          message: ',      .',\n          icon: AlertCircle,\n          color: 'red',\n          actions: ['login']\n        };\n      }\n      \n      if (status === 429) {\n        return {\n          type: 'rate_limit',\n          title: '  ',\n          message: '    .     .',\n          icon: Clock,\n          color: 'orange',\n          actions: ['wait']\n        };\n      }\n      \n      if (status === 503) {\n        return {\n          type: 'overload',\n          title: ' ',\n          message: '  .     .',\n          icon: Zap,\n          color: 'yellow',\n          actions: ['retry']\n        };\n      }\n      \n      if (status >= 500) {\n        return {\n          type: 'server',\n          title: ' ',\n          message: '   .      .',\n          icon: Server,\n          color: 'red',\n          actions: ['retry', 'support']\n        };\n      }\n    }\n\n    //  \n    if (error?.request && !error?.response) {\n      return {\n        type: 'network',\n        title: '  ',\n        message: '    .    .',\n        icon: WifiOff,\n        color: 'red',\n        actions: ['reconnect', 'retry']\n      };\n    }\n\n    //   \n    if (error?.message?.includes('') || error?.message?.includes('')) {\n      return {\n        type: 'ai_model',\n        title: '  ',\n        message: '    .  .',\n        icon: AlertCircle,\n        color: 'orange',\n        actions: ['retry', 'support']\n      };\n    }\n\n    //  \n    return {\n      type: 'general',\n      title: ' ',\n      message: error?.message || '-   .   .',\n      icon: AlertCircle,\n      color: 'red',\n      actions: ['retry']\n    };\n  };\n\n  const errorInfo = getErrorInfo(error);\n  const Icon = errorInfo.icon;\n\n  const getColorClasses = (color) => {\n    const colorMap = {\n      red: 'bg-red-50 border-red-200 text-red-800',\n      orange: 'bg-orange-50 border-orange-200 text-orange-800',\n      yellow: 'bg-yellow-50 border-yellow-200 text-yellow-800',\n      blue: 'bg-blue-50 border-blue-200 text-blue-800'\n    };\n    return colorMap[color] || colorMap.red;\n  };\n\n  const getButtonColorClasses = (color) => {\n    const colorMap = {\n      red: 'bg-red-600 hover:bg-red-700 text-white',\n      orange: 'bg-orange-600 hover:bg-orange-700 text-white',\n      yellow: 'bg-yellow-600 hover:bg-yellow-700 text-white',\n      blue: 'bg-blue-600 hover:bg-blue-700 text-white'\n    };\n    return colorMap[color] || colorMap.red;\n  };\n\n  const renderActions = () => {\n    return errorInfo.actions.map(action => {\n      switch (action) {\n        case 'retry':\n          return (\n            <button\n              key=\"retry\"\n              onClick={onRetry}\n              className={`px-3 py-1 text-sm font-medium rounded transition-colors ${getButtonColorClasses(errorInfo.color)}`}\n            >\n              <RefreshCw className=\"w-4 h-4 inline mr-1\" />\n              \n            </button>\n          );\n        \n        case 'reconnect':\n          return (\n            <button\n              key=\"reconnect\"\n              onClick={onReconnect}\n              className={`px-3 py-1 text-sm font-medium rounded transition-colors ${getButtonColorClasses(errorInfo.color)}`}\n            >\n              <Wifi className=\"w-4 h-4 inline mr-1\" />\n              \n            </button>\n          );\n        \n        case 'login':\n          return (\n            <button\n              key=\"login\"\n              onClick={() => window.location.href = '/login'}\n              className={`px-3 py-1 text-sm font-medium rounded transition-colors ${getButtonColorClasses(errorInfo.color)}`}\n            >\n              \n            </button>\n          );\n        \n        case 'support':\n          return (\n            <button\n              key=\"support\"\n              onClick={() => window.open('mailto:support@advacodex.com', '_blank')}\n              className=\"px-3 py-1 text-sm font-medium bg-gray-600 hover:bg-gray-700 text-white rounded transition-colors\"\n            >\n              \n            </button>\n          );\n        \n        case 'wait':\n          return (\n            <span key=\"wait\" className=\"text-sm text-gray-600\">\n               1-2 \n            </span>\n          );\n        \n        default:\n          return null;\n      }\n    });\n  };\n\n  if (variant === \"toast\") {\n    return (\n      <div className={`fixed top-4 right-4 z-50 max-w-sm ${className}`}>\n        <div className={`p-4 rounded-lg border shadow-lg ${getColorClasses(errorInfo.color)}`}>\n          <div className=\"flex items-start space-x-3\">\n            {showIcon && <Icon className=\"w-5 h-5 mt-0.5 flex-shrink-0\" />}\n            <div className=\"flex-1\">\n              <h4 className=\"text-sm font-medium mb-1\">{errorInfo.title}</h4>\n              <p className=\"text-sm opacity-90 mb-3\">{errorInfo.message}</p>\n              <div className=\"flex space-x-2\">\n                {renderActions()}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (variant === \"inline\") {\n    return (\n      <div className={`flex items-center space-x-2 p-2 rounded ${getColorClasses(errorInfo.color)} ${className}`}>\n        {showIcon && <Icon className=\"w-4 h-4 flex-shrink-0\" />}\n        <span className=\"text-sm flex-1\">{errorInfo.message}</span>\n        <div className=\"flex space-x-1\">\n          {renderActions()}\n        </div>\n      </div>\n    );\n  }\n\n  // Default variant\n  return (\n    <div className={`p-4 rounded-lg border ${getColorClasses(errorInfo.color)} ${className}`}>\n      <div className=\"flex items-start space-x-3\">\n        {showIcon && <Icon className=\"w-5 h-5 mt-0.5 flex-shrink-0\" />}\n        <div className=\"flex-1\">\n          <h3 className=\"text-sm font-medium mb-1\">{errorInfo.title}</h3>\n          <p className=\"text-sm opacity-90 mb-3\">{errorInfo.message}</p>\n          <div className=\"flex space-x-2\">\n            {renderActions()}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ErrorMessage;","import React, { useState, useEffect } from 'react';\nimport { Bot, Square, Clock, Zap, Brain } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\n/**\n *   \" ...\"   \n *   6.4, 6.5  \n */\nconst AIThinkingIndicator = ({ \n  isGenerating, \n  onStop, \n  startTime,\n  estimatedTime,\n  className = \"\",\n  variant = \"default\" // \"default\", \"compact\", \"detailed\"\n}) => {\n  const [elapsedTime, setElapsedTime] = useState(0);\n  const [thinkingPhase, setThinkingPhase] = useState(0);\n\n  //  \"\"     \n  const thinkingPhases = [\n    { text: \"   ...\", icon: Brain },\n    { text: \"   ...\", icon: Zap },\n    { text: \"  ...\", icon: Bot },\n    { text: \"   ...\", icon: Clock }\n  ];\n\n  //    \n  useEffect(() => {\n    if (!isGenerating || !startTime) {\n      setElapsedTime(0);\n      setThinkingPhase(0);\n      return;\n    }\n\n    const interval = setInterval(() => {\n      const elapsed = Math.floor((Date.now() - startTime) / 1000);\n      setElapsedTime(elapsed);\n\n      //    5 \n      const phase = Math.floor(elapsed / 5) % thinkingPhases.length;\n      setThinkingPhase(phase);\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [isGenerating, startTime, thinkingPhases.length]);\n\n  const formatTime = (seconds) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return mins > 0 ? `${mins}:${secs.toString().padStart(2, '0')}` : `${secs}`;\n  };\n\n  const getProgressPercentage = () => {\n    if (!estimatedTime) return 0;\n    return Math.min((elapsedTime / estimatedTime) * 100, 95); //  95%  \n  };\n\n  const currentPhase = thinkingPhases[thinkingPhase];\n  const PhaseIcon = currentPhase.icon;\n\n  if (!isGenerating) return null;\n\n  if (variant === \"compact\") {\n    return (\n      <div className={`flex items-center space-x-2 ${className}`}>\n        <motion.div\n          animate={{ rotate: 360 }}\n          transition={{ duration: 2, repeat: Infinity, ease: \"linear\" }}\n          className=\"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full\"\n        />\n        <span className=\"text-sm text-gray-600\"> ...</span>\n        {onStop && (\n          <button\n            onClick={onStop}\n            className=\"p-1 text-red-600 hover:text-red-700 hover:bg-red-50 rounded transition-colors\"\n            title=\" \"\n          >\n            <Square className=\"w-3 h-3\" />\n          </button>\n        )}\n      </div>\n    );\n  }\n\n  if (variant === \"detailed\") {\n    return (\n      <div className={`bg-white border border-gray-200 rounded-lg p-4 shadow-sm ${className}`}>\n        <div className=\"flex items-start space-x-3\">\n          <div className=\"w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center\">\n            <motion.div\n              animate={{ rotate: 360 }}\n              transition={{ duration: 2, repeat: Infinity, ease: \"linear\" }}\n            >\n              <Bot className=\"w-4 h-4 text-white\" />\n            </motion.div>\n          </div>\n          \n          <div className=\"flex-1\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <div className=\"flex items-center space-x-2\">\n                <PhaseIcon className=\"w-4 h-4 text-blue-600\" />\n                <AnimatePresence mode=\"wait\">\n                  <motion.span\n                    key={thinkingPhase}\n                    initial={{ opacity: 0, y: 10 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    exit={{ opacity: 0, y: -10 }}\n                    className=\"text-sm font-medium text-gray-700\"\n                  >\n                    {currentPhase.text}\n                  </motion.span>\n                </AnimatePresence>\n              </div>\n              \n              <div className=\"flex items-center space-x-2\">\n                <span className=\"text-xs text-gray-500\">\n                  {formatTime(elapsedTime)}\n                </span>\n                {onStop && (\n                  <button\n                    onClick={onStop}\n                    className=\"px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors flex items-center space-x-1\"\n                    title=\" \"\n                  >\n                    <Square className=\"w-3 h-3\" />\n                    <span></span>\n                  </button>\n                )}\n              </div>\n            </div>\n            \n            {/* - (   ) */}\n            {estimatedTime && (\n              <div className=\"w-full bg-gray-200 rounded-full h-2 mb-2\">\n                <motion.div\n                  className=\"bg-blue-600 h-2 rounded-full\"\n                  initial={{ width: 0 }}\n                  animate={{ width: `${getProgressPercentage()}%` }}\n                  transition={{ duration: 0.5 }}\n                />\n              </div>\n            )}\n            \n            {/*   */}\n            <div className=\"flex items-center justify-between text-xs text-gray-500\">\n              <span>\n                {estimatedTime ? ` : ${formatTime(estimatedTime)}` : '  ...'}\n              </span>\n              {elapsedTime > 30 && (\n                <span className=\"text-orange-600\">\n                   ,   \n                </span>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Default variant\n  return (\n    <div className={`flex items-center justify-between p-3 bg-white border border-gray-200 rounded-lg ${className}`}>\n      <div className=\"flex items-center space-x-3\">\n        <motion.div\n          animate={{ rotate: 360 }}\n          transition={{ duration: 2, repeat: Infinity, ease: \"linear\" }}\n          className=\"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full\"\n        />\n        \n        <div>\n          <AnimatePresence mode=\"wait\">\n            <motion.div\n              key={thinkingPhase}\n              initial={{ opacity: 0, x: 10 }}\n              animate={{ opacity: 1, x: 0 }}\n              exit={{ opacity: 0, x: -10 }}\n              className=\"flex items-center space-x-2\"\n            >\n              <PhaseIcon className=\"w-4 h-4 text-blue-600\" />\n              <span className=\"text-sm font-medium text-gray-700\">\n                {currentPhase.text}\n              </span>\n            </motion.div>\n          </AnimatePresence>\n          \n          <div className=\"flex items-center space-x-2 mt-1\">\n            <span className=\"text-xs text-gray-500\">\n              {formatTime(elapsedTime)}\n            </span>\n            {elapsedTime > 60 && (\n              <span className=\"text-xs text-orange-600\">\n                  \n              </span>\n            )}\n          </div>\n        </div>\n      </div>\n      \n      {onStop && (\n        <button\n          onClick={onStop}\n          className=\"px-3 py-1 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors flex items-center space-x-1\"\n          title=\" \"\n        >\n          <Square className=\"w-3 h-3\" />\n          <span></span>\n        </button>\n      )}\n    </div>\n  );\n};\n\nexport default AIThinkingIndicator;","import React, { useState, useEffect } from 'react';\nimport { \n  Wifi, \n  WifiOff, \n  RefreshCw, \n  CheckCircle, \n  AlertCircle, \n  Clock,\n  Activity,\n  Zap,\n  Settings\n} from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\n/**\n *       \n *   6.2, 6.3  \n */\nconst EnhancedConnectionStatus = ({ \n  websocket, \n  onReconnect,\n  onForceReconnect,\n  showDetails = false,\n  autoHide = true,\n  className = \"\" \n}) => {\n  const [status, setStatus] = useState(null);\n  const [isVisible, setIsVisible] = useState(false);\n  const [showDetailedInfo, setShowDetailedInfo] = useState(false);\n  const [lastError, setLastError] = useState(null);\n  const [reconnectCountdown, setReconnectCountdown] = useState(0);\n\n  useEffect(() => {\n    if (!websocket) return;\n\n    const updateStatus = () => {\n      const currentStatus = websocket.getStatus();\n      const userStatus = websocket.getUserFriendlyStatus();\n      setStatus({ ...currentStatus, ...userStatus });\n    };\n\n    updateStatus();\n\n    const handleStateChange = (state) => {\n      updateStatus();\n      \n      //    \n      if (['connecting', 'reconnecting', 'failed'].includes(state)) {\n        setIsVisible(true);\n      } else if (state === 'connected') {\n        setIsVisible(true);\n        if (autoHide) {\n          setTimeout(() => setIsVisible(false), 3000);\n        }\n      }\n    };\n\n    const handleError = (error) => {\n      setLastError(error);\n      setIsVisible(true);\n      updateStatus();\n    };\n\n    websocket.on('stateChange', handleStateChange);\n    websocket.on('error', handleError);\n    websocket.on('open', updateStatus);\n    websocket.on('close', updateStatus);\n\n    const interval = setInterval(updateStatus, 5000);\n\n    return () => {\n      websocket.off('stateChange', handleStateChange);\n      websocket.off('error', handleError);\n      websocket.off('open', updateStatus);\n      websocket.off('close', updateStatus);\n      clearInterval(interval);\n    };\n  }, [websocket, autoHide]);\n\n  //    \n  useEffect(() => {\n    if (status?.connectionState === 'reconnecting' && websocket) {\n      const startCountdown = () => {\n        const delay = websocket.options?.reconnectDelay || 1000;\n        const attempts = status.reconnectAttempts || 0;\n        const actualDelay = Math.min(delay * Math.pow(2, attempts), 30000);\n        \n        setReconnectCountdown(Math.ceil(actualDelay / 1000));\n        \n        const countdownInterval = setInterval(() => {\n          setReconnectCountdown(prev => {\n            if (prev <= 1) {\n              clearInterval(countdownInterval);\n              return 0;\n            }\n            return prev - 1;\n          });\n        }, 1000);\n        \n        return countdownInterval;\n      };\n      \n      const interval = startCountdown();\n      return () => clearInterval(interval);\n    }\n  }, [status?.connectionState, status?.reconnectAttempts, websocket]);\n\n  if (!status) return null; \n const getStatusIcon = () => {\n    switch (status.icon) {\n      case 'connected':\n        return <CheckCircle className=\"h-4 w-4 text-green-600\" />;\n      case 'connecting':\n      case 'reconnecting':\n        return (\n          <motion.div\n            animate={{ rotate: 360 }}\n            transition={{ duration: 1, repeat: Infinity, ease: \"linear\" }}\n          >\n            <RefreshCw className=\"h-4 w-4 text-blue-600\" />\n          </motion.div>\n        );\n      case 'disconnected':\n        return <WifiOff className=\"h-4 w-4 text-gray-600\" />;\n      case 'error':\n        return <AlertCircle className=\"h-4 w-4 text-red-600\" />;\n      default:\n        return <Wifi className=\"h-4 w-4 text-gray-600\" />;\n    }\n  };\n\n  const getStatusColor = () => {\n    switch (status.color) {\n      case 'green':\n        return 'bg-green-50 border-green-200 text-green-800';\n      case 'yellow':\n        return 'bg-yellow-50 border-yellow-200 text-yellow-800';\n      case 'orange':\n        return 'bg-orange-50 border-orange-200 text-orange-800';\n      case 'red':\n        return 'bg-red-50 border-red-200 text-red-800';\n      case 'blue':\n        return 'bg-blue-50 border-blue-200 text-blue-800';\n      case 'gray':\n      default:\n        return 'bg-gray-50 border-gray-200 text-gray-800';\n    }\n  };\n\n  const handleReconnectClick = () => {\n    if (onForceReconnect) {\n      onForceReconnect();\n    } else if (onReconnect) {\n      onReconnect();\n    } else if (websocket) {\n      websocket.reconnect();\n    }\n  };\n\n  //    \n  if (!showDetails && !isVisible) {\n    return (\n      <div className={`flex items-center space-x-2 ${className}`}>\n        <div className=\"flex items-center space-x-1\">\n          <div className={`w-2 h-2 rounded-full ${\n            status.connected ? 'bg-green-500 animate-pulse' : 'bg-red-500'\n          }`}></div>\n          <span className={`text-sm font-medium ${\n            status.connected ? 'text-green-600' : 'text-red-600'\n          }`}>\n            {status.connected ? '' : ''}\n          </span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={className}>\n      <AnimatePresence>\n        {(isVisible || showDetails) && (\n          <motion.div\n            initial={{ opacity: 0, y: -10 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -10 }}\n            className={`\n              flex items-center justify-between p-3 rounded-lg border transition-all duration-300\n              ${getStatusColor()}\n            `}\n          >\n            <div className=\"flex items-center space-x-3\">\n              {getStatusIcon()}\n              <div>\n                <div className=\"text-sm font-medium\">{status.text}</div>\n                \n                {/*   */}\n                {status.reconnectAttempts > 0 && (\n                  <div className=\"text-xs opacity-75\">\n                     {status.reconnectAttempts}/{websocket?.options?.maxReconnectAttempts || 10}\n                    {reconnectCountdown > 0 && `    ${reconnectCountdown}`}\n                  </div>\n                )}\n                \n                {status.queuedMessages > 0 && (\n                  <div className=\"text-xs opacity-75\">\n                    {status.queuedMessages}   \n                  </div>\n                )}\n                \n                {lastError && status.connectionState === 'failed' && (\n                  <div className=\"text-xs text-red-600 mt-1\">\n                    {lastError.message || ' '}\n                  </div>\n                )}\n              </div>\n            </div>\n\n            <div className=\"flex items-center space-x-2\">\n              {/*   */}\n              {['failed', 'disconnected'].includes(status.connectionState) && (\n                <button\n                  onClick={handleReconnectClick}\n                  className=\"px-3 py-1 text-xs font-medium bg-white rounded border hover:bg-gray-50 transition-colors\"\n                >\n                  \n                </button>\n              )}\n\n              {/*    */}\n              {status.connectionState === 'reconnecting' && (\n                <button\n                  onClick={handleReconnectClick}\n                  className=\"px-3 py-1 text-xs font-medium bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors\"\n                >\n                   \n                </button>\n              )}\n\n              {/*   */}\n              {showDetails && (\n                <button\n                  onClick={() => setShowDetailedInfo(!showDetailedInfo)}\n                  className=\"p-1 hover:bg-white hover:bg-opacity-50 rounded transition-colors\"\n                >\n                  <Activity className=\"h-4 w-4\" />\n                </button>\n              )}\n\n              {/*   */}\n              {isVisible && !showDetails && autoHide && (\n                <button\n                  onClick={() => setIsVisible(false)}\n                  className=\"p-1 hover:bg-white hover:bg-opacity-50 rounded transition-colors\"\n                >\n                  \n                </button>\n              )}\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/*   */}\n      <AnimatePresence>\n        {showDetailedInfo && status.stats && (\n          <motion.div\n            initial={{ opacity: 0, height: 0 }}\n            animate={{ opacity: 1, height: 'auto' }}\n            exit={{ opacity: 0, height: 0 }}\n            className=\"mt-2 p-3 bg-white rounded-lg border border-gray-200 text-sm\"\n          >\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <div className=\"font-medium text-gray-700 mb-2\"> </div>\n                <div className=\"space-y-1 text-gray-600\">\n                  <div className=\"flex justify-between\">\n                    <span>:</span>\n                    <span>{status.stats.totalConnections}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>:</span>\n                    <span>{status.stats.totalReconnections}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>:</span>\n                    <span>{status.stats.totalMessages}</span>\n                  </div>\n                </div>\n              </div>\n              \n              <div>\n                <div className=\"font-medium text-gray-700 mb-2\"> </div>\n                <div className=\"space-y-1 text-gray-600\">\n                  {status.stats.lastConnectedAt && (\n                    <div className=\"flex items-center space-x-1\">\n                      <Clock className=\"h-3 w-3\" />\n                      <span className=\"text-xs\">\n                        {new Date(status.stats.lastConnectedAt).toLocaleTimeString()}\n                      </span>\n                    </div>\n                  )}\n                  {status.lastPong && (\n                    <div className=\"flex items-center space-x-1\">\n                      <Zap className=\"h-3 w-3\" />\n                      <span className=\"text-xs\">\n                        Ping: {Date.now() - status.lastPong}ms \n                      </span>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n};\n\nexport default EnhancedConnectionStatus;","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport ErrorMessage from './ErrorMessage';\nimport AIThinkingIndicator from './AIThinkingIndicator';\nimport EnhancedConnectionStatus from './EnhancedConnectionStatus';\n\n/**\n *       \n *   6.1, 6.2, 6.3, 6.4, 6.5  \n */\nconst StatusNotificationSystem = ({ \n  websocket,\n  isGenerating,\n  generationStartTime,\n  onStopGeneration,\n  onReconnect,\n  onForceReconnect,\n  className = \"\"\n}) => {\n  const [notifications, setNotifications] = useState([]);\n  const [connectionError, setConnectionError] = useState(null);\n  const [modelError, setModelError] = useState(null);\n  const lastNotificationRef = useRef({});\n  const debounceTimersRef = useRef({});\n\n  //  \n  const removeNotification = useCallback((id) => {\n    setNotifications(prev => prev.filter(n => n.id !== id));\n  }, []);\n\n  //      \n  const addNotification = useCallback((notification) => {\n    //         \n    const notificationKey = `${notification.type}_${notification.title}_${notification.message}`;\n    \n    // ,         \n    const lastShown = lastNotificationRef.current[notificationKey];\n    const now = Date.now();\n    if (lastShown && (now - lastShown) < 5000) {\n      //        5   - \n      return null;\n    }\n\n    //     \n    if (debounceTimersRef.current[notificationKey]) {\n      clearTimeout(debounceTimersRef.current[notificationKey]);\n    }\n\n    const timerId = setTimeout(() => {\n      const id = Date.now() + Math.random();\n      const newNotification = {\n        id,\n        timestamp: Date.now(),\n        autoHide: true,\n        duration: 5000,\n        ...notification,\n        key: notificationKey\n      };\n\n      setNotifications(prev => {\n        //        \n        const filtered = prev.filter(n => \n          !(n.key === notificationKey && n.type === notification.type)\n        );\n        return [...filtered, newNotification];\n      });\n\n      lastNotificationRef.current[notificationKey] = now;\n\n      //  \n      if (newNotification.autoHide) {\n        setTimeout(() => {\n          removeNotification(id);\n        }, newNotification.duration);\n      }\n    }, notification.type === 'error' ? 500 : 100); //    500,   100\n\n    debounceTimersRef.current[notificationKey] = timerId;\n\n    return notificationKey;\n  }, [removeNotification]);\n\n  //    \n  useEffect(() => {\n    return () => {\n      Object.values(debounceTimersRef.current).forEach(timer => {\n        if (timer) clearTimeout(timer);\n      });\n    };\n  }, []);\n\n  //   WebSocket   \n  useEffect(() => {\n    if (!websocket) return;\n\n    let stateChangeTimer = null;\n    let errorTimer = null;\n    let lastState = null;\n    let errorCount = 0;\n\n    const handleStateChange = (state) => {\n      //       \n      if (lastState === state) return;\n      lastState = state;\n\n      //   \n      if (stateChangeTimer) {\n        clearTimeout(stateChangeTimer);\n      }\n\n      //   \n      stateChangeTimer = setTimeout(() => {\n        switch (state) {\n          case 'connected':\n            setConnectionError(null);\n            errorCount = 0; //      \n            //       \n            setNotifications(prev => prev.filter(n => \n              !(n.type === 'error' && n.title === ' ')\n            ));\n            addNotification({\n              type: 'success',\n              title: ' ',\n              message: '    ',\n              duration: 3000\n            });\n            break;\n          \n          case 'reconnecting':\n            //       \n            addNotification({\n              type: 'info',\n              title: '',\n              message: '    ...',\n              autoHide: false\n            });\n            break;\n          \n          case 'failed':\n            errorCount++;\n            //         \n            if (errorCount <= 3) {\n              const error = { code: 1006, message: '    ' };\n              setConnectionError(error);\n              //        \n              setNotifications(prev => prev.filter(n => \n                !(n.type === 'error' && n.title === ' ')\n              ));\n              addNotification({\n                type: 'error',\n                title: ' ',\n                message: '    .  -.',\n                autoHide: false,\n                actions: [\n                  {\n                    label: '',\n                    action: onForceReconnect || onReconnect,\n                    primary: true\n                  }\n                ]\n              });\n            }\n            break;\n        }\n      }, 300); //  300\n    };\n\n    const handleError = (error) => {\n      console.error('WebSocket error:', error);\n      \n      //    \n      if (errorTimer) {\n        clearTimeout(errorTimer);\n      }\n\n      //  \n      errorTimer = setTimeout(() => {\n        let errorNotification = {\n          type: 'error',\n          title: ' ',\n          message: '     ',\n          autoHide: false\n        };\n\n        if (error.code === 1008) {\n          errorNotification = {\n            type: 'error',\n            title: ' ',\n            message: '  .     .',\n            autoHide: false,\n            actions: [\n              {\n                label: '',\n                action: () => window.location.href = '/login',\n                primary: true\n              }\n            ]\n          };\n        }\n\n        //         \n        setNotifications(prev => prev.filter(n => \n          !(n.type === 'error' && n.title === errorNotification.title)\n        ));\n\n        addNotification(errorNotification);\n      }, 500); //   500\n    };\n\n    websocket.on('stateChange', handleStateChange);\n    websocket.on('error', handleError);\n\n    return () => {\n      if (stateChangeTimer) clearTimeout(stateChangeTimer);\n      if (errorTimer) clearTimeout(errorTimer);\n      websocket.off('stateChange', handleStateChange);\n      websocket.off('error', handleError);\n    };\n  }, [websocket, addNotification, onReconnect, onForceReconnect]);\n\n  // API   \n  const showError = useCallback((error, options = {}) => {\n    return addNotification({\n      type: 'error',\n      title: '',\n      message: typeof error === 'string' ? error : error.message,\n      ...options\n    });\n  }, [addNotification]);\n\n  const showSuccess = useCallback((message, options = {}) => {\n    return addNotification({\n      type: 'success',\n      title: '',\n      message,\n      ...options\n    });\n  }, [addNotification]);\n\n  const showInfo = useCallback((message, options = {}) => {\n    return addNotification({\n      type: 'info',\n      title: '',\n      message,\n      ...options\n    });\n  }, [addNotification]);\n\n  const showModelUnavailable = useCallback(() => {\n    setModelError({ message: '   ' });\n    return addNotification({\n      type: 'warning',\n      title: '  ',\n      message: '    .  .',\n      autoHide: false,\n      actions: [\n        {\n          label: '',\n          action: () => window.location.reload(),\n          primary: true\n        }\n      ]\n    });\n  }, [addNotification]);\n\n  //  API     \n  useEffect(() => {\n    window.statusNotifications = {\n      showError,\n      showSuccess,\n      showInfo,\n      showModelUnavailable,\n      removeNotification\n    };\n\n    return () => {\n      delete window.statusNotifications;\n    };\n  }, [showError, showSuccess, showInfo, showModelUnavailable, removeNotification]);\n\n  return (\n    <div className={`fixed inset-0 pointer-events-none z-50 ${className}`}>\n      {/*    */}\n      {isGenerating && (\n        <div className=\"absolute top-20 left-1/2 transform -translate-x-1/2 pointer-events-auto\">\n          <AIThinkingIndicator\n            isGenerating={isGenerating}\n            startTime={generationStartTime}\n            onStop={onStopGeneration}\n            variant=\"detailed\"\n          />\n        </div>\n      )}\n\n      {/*   */}\n      <div className=\"absolute top-4 right-4 pointer-events-auto\">\n        <EnhancedConnectionStatus\n          websocket={websocket}\n          onReconnect={onReconnect}\n          onForceReconnect={onForceReconnect}\n          showDetails={false}\n          autoHide={true}\n        />\n      </div>\n\n      {/*  */}\n      <div className=\"absolute top-4 left-4 space-y-2 pointer-events-auto max-w-sm\">\n        <AnimatePresence>\n          {notifications.map((notification) => (\n            <motion.div\n              key={notification.id}\n              initial={{ opacity: 0, x: -100, scale: 0.9 }}\n              animate={{ opacity: 1, x: 0, scale: 1 }}\n              exit={{ opacity: 0, x: -100, scale: 0.9 }}\n              transition={{ duration: 0.3 }}\n            >\n              <StatusNotification\n                notification={notification}\n                onClose={() => removeNotification(notification.id)}\n              />\n            </motion.div>\n          ))}\n        </AnimatePresence>\n      </div>\n    </div>\n  );\n};\n\n//   \nconst StatusNotification = ({ notification, onClose }) => {\n  const getNotificationStyles = (type) => {\n    const styles = {\n      success: 'bg-green-50 border-green-200 text-green-800',\n      error: 'bg-red-50 border-red-200 text-red-800',\n      warning: 'bg-yellow-50 border-yellow-200 text-yellow-800',\n      info: 'bg-blue-50 border-blue-200 text-blue-800'\n    };\n    return styles[type] || styles.info;\n  };\n\n  return (\n    <div className={`p-4 rounded-lg border shadow-lg ${getNotificationStyles(notification.type)}`}>\n      <div className=\"flex items-start justify-between\">\n        <div className=\"flex-1\">\n          <h4 className=\"text-sm font-medium mb-1\">{notification.title}</h4>\n          <p className=\"text-sm opacity-90\">{notification.message}</p>\n          \n          {notification.actions && (\n            <div className=\"flex space-x-2 mt-3\">\n              {notification.actions.map((action, index) => (\n                <button\n                  key={index}\n                  onClick={action.action}\n                  className={`px-3 py-1 text-xs font-medium rounded transition-colors ${\n                    action.primary\n                      ? 'bg-blue-600 text-white hover:bg-blue-700'\n                      : 'bg-white border hover:bg-gray-50'\n                  }`}\n                >\n                  {action.label}\n                </button>\n              ))}\n            </div>\n          )}\n        </div>\n        \n        <button\n          onClick={onClose}\n          className=\"ml-3 text-gray-400 hover:text-gray-600 transition-colors\"\n        >\n          \n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default StatusNotificationSystem;","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { Send, Paperclip, Bot, User, Wifi, WifiOff, File, X, Lightbulb, Mic, Square, RefreshCw, Menu, Settings, Check, History, Clock, ChevronLeft } from 'lucide-react';\nimport { useChatWebSocket } from '../hooks/useChatWebSocket';\nimport { useStatusNotifications } from '../hooks/useStatusNotifications';\nimport {\n  LazyFileUpload,\n  LazyQuestionTemplates\n} from '../components/LazyComponent';\nimport VoiceRecorder from '../components/VoiceRecorder';\nimport VoicePlayer from '../components/VoicePlayer';\nimport ChatHistory from '../components/ChatHistory';\nimport EnhancedResponse from '../components/EnhancedResponse';\nimport FeedbackButtons from '../components/FeedbackButtons';\nimport WebSocketStatus from '../components/WebSocketStatus';\nimport ErrorMessage from '../components/ErrorMessage';\nimport AIThinkingIndicator from '../components/AIThinkingIndicator';\nimport StatusNotificationSystem from '../components/StatusNotificationSystem';\nimport axios from 'axios';\nimport { getApiUrl } from '../config/api';\n\nconst Chat = () => {\n  const [messages, setMessages] = useState([]);\n  const [inputMessage, setInputMessage] = useState('');\n  const [isGenerating, setIsGenerating] = useState(false);\n  const [generationStartTime, setGenerationStartTime] = useState(null);\n  const [sessionId, setSessionId] = useState(null);\n  const [attachedFiles, setAttachedFiles] = useState([]);\n  const [showFileUpload, setShowFileUpload] = useState(false);\n  const [showTemplates, setShowTemplates] = useState(false);\n  const [showVoiceRecorder, setShowVoiceRecorder] = useState(false);\n  const [isInputExpanded, setIsInputExpanded] = useState(false);\n  const [showModeMenu, setShowModeMenu] = useState(false);\n  const [chatMode, setChatMode] = useState('basic'); // 'basic'  'expert'\n  const [modeNotification, setModeNotification] = useState(null);\n  const inputAreaRef = useRef(null);\n  const modeMenuRef = useRef(null);\n  //      ,   - \n  const [isHistoryCollapsed, setIsHistoryCollapsed] = useState(() => {\n    //     \n    if (typeof window !== 'undefined') {\n      const isMobile = window.innerWidth < 768; // md breakpoint\n      //     (true),    (false)\n      return isMobile;\n    }\n    return false;\n  });\n  const [focusHistorySearch, setFocusHistorySearch] = useState(false);\n\n  //     \n  useEffect(() => {\n    if (focusHistorySearch) {\n      const timeoutId = setTimeout(() => {\n        setFocusHistorySearch(false);\n      }, 1000); //   1   \n      return () => clearTimeout(timeoutId);\n    }\n  }, [focusHistorySearch]);\n  const [lastError, setLastError] = useState(null);\n  const messagesEndRef = useRef(null);\n  const messagesContainerRef = useRef(null);\n  const textareaRef = useRef(null);\n  const autoScrollRef = useRef(true);\n  const currentStreamRef = useRef(null);\n  const initializedRef = useRef(false);\n  const [announcement, setAnnouncement] = useState('');\n\n  //   \n  const { showGenerationStopped, showError, showSuccess } = useStatusNotifications();\n\n  const isNearBottom = () => {\n    const el = messagesContainerRef.current;\n    if (!el) return true;\n    const threshold = 120; // px\n    const distanceFromBottom = el.scrollHeight - el.scrollTop - el.clientHeight;\n    return distanceFromBottom <= threshold;\n  };\n\n  const scrollToBottom = () => {\n    const el = messagesContainerRef.current;\n    if (!el) return;\n    el.scrollTop = el.scrollHeight;\n  };\n\n  //    (   WebSocket- )\n  let stopGeneration; //     wsStopGeneration\n\n  //     WebSocket\n  const handleNewMessage = useCallback((messageData) => {\n    if (!messageData || !messageData.content) {\n      console.warn('Received invalid message data:', messageData);\n      return;\n    }\n\n    const aiMessage = {\n      id: `ai_${Date.now()}`,\n      type: 'ai',\n      content: messageData.content,\n      timestamp: new Date().toISOString(),\n      enhancements: messageData.enhancements || {}\n    };\n\n    setMessages(prev => [...prev, aiMessage]);\n    setIsGenerating(false);\n  }, []);\n\n  // WebSocket \n  const {\n    isConnected,\n    connectionState,\n    websocket,\n    sendChatMessage: wsSendChatMessage,\n    stopGeneration: wsStopGeneration,\n    forceReconnect\n  } = useChatWebSocket(sessionId, handleNewMessage);\n\n  //     stopGeneration,   wsStopGeneration\n  stopGeneration = useCallback(() => {\n    if (currentStreamRef.current) {\n      currentStreamRef.current.abort();\n      currentStreamRef.current = null;\n    }\n\n    if (wsStopGeneration) {\n      wsStopGeneration();\n    }\n\n    setIsGenerating(false);\n    setGenerationStartTime(null);\n    \n    //    \n    showGenerationStopped();\n  }, [wsStopGeneration]);\n\n  //   -   \n  useEffect(() => {\n    if (initializedRef.current) return;\n    \n    initializedRef.current = true;\n    \n    //     \n    if ('serviceWorker' in navigator && 'caches' in window) {\n      caches.keys().then(cacheNames => {\n        cacheNames.forEach(cacheName => {\n          if (cacheName.includes('advakod')) {\n            console.log('  :', cacheName);\n            caches.delete(cacheName);\n          }\n        });\n      }).catch(err => console.error('  :', err));\n    }\n    \n    //      \n    setMessages([{\n      id: 'welcome',\n      type: 'ai',\n      content: '!    AI-.      ,     .      .',\n      timestamp: new Date().toISOString()\n    }]);\n    \n    // Session ID       \n  }, []);\n\n  //       \n  useEffect(() => {\n    console.log('useEffect sessionId :', sessionId, 'initialized:', initializedRef.current);\n    \n    const loadSessionMessages = async () => {\n      //      (   sessionId    )\n      if (!initializedRef.current && !sessionId) {\n        console.log('  -    sessionId');\n        return;\n      }\n      \n      if (!sessionId) {\n        console.log(' sessionId,   ');\n        //   sessionId,      \n        setMessages([{\n          id: 'welcome',\n          type: 'ai',\n          content: '!    AI-.      ,     .      .',\n          timestamp: new Date().toISOString()\n        }]);\n        return;\n      }\n\n      console.log('    :', sessionId);\n      \n      try {\n        const apiUrl = getApiUrl(`/chat/sessions/${sessionId}/messages`);\n        console.log('   API:', apiUrl);\n        \n        const response = await axios.get(apiUrl, {\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('token')}`\n          }\n        });\n        const messagesData = response.data || [];\n        \n        console.log('  :', messagesData.length);\n        \n        //     ,  \n        try {\n          const sessionResponse = await axios.get(getApiUrl(`/chat/sessions/${sessionId}`), {\n            headers: {\n              'Authorization': `Bearer ${localStorage.getItem('token')}`\n            }\n          });\n          if (sessionResponse.data?.chat_mode) {\n            setChatMode(sessionResponse.data.chat_mode);\n            console.log('     :', sessionResponse.data.chat_mode);\n          }\n        } catch (err) {\n          console.warn('      :', err);\n        }\n        \n        //     \n        const formattedMessages = messagesData.map(msg => ({\n          id: `msg_${msg.id}`,\n          type: msg.role === 'user' ? 'user' : 'ai',\n          content: msg.content,\n          timestamp: msg.created_at,\n          enhancements: msg.enhancements || {}\n        }));\n\n        //   ,  \n        if (formattedMessages.length === 0) {\n          console.log('  ,   ');\n          setMessages([{\n            id: 'welcome',\n            type: 'ai',\n            content: '!    AI-.      ,     .      .',\n            timestamp: new Date().toISOString()\n          }]);\n        } else {\n          console.log('  :', formattedMessages.length);\n          setMessages(formattedMessages);\n        }\n        \n        //    \n        setTimeout(() => {\n          scrollToBottom();\n          autoScrollRef.current = true;\n        }, 100);\n      } catch (error) {\n        console.error('    :', error);\n        console.error(' :', error.response?.data || error.message);\n        console.error(':', error.response?.status);\n        setLastError(error);\n        setMessages([{\n          id: 'error',\n          type: 'error',\n          content: `   : ${error.response?.data?.detail || error.message}.   .`,\n          timestamp: new Date().toISOString()\n        }]);\n      }\n    };\n\n    loadSessionMessages();\n  }, [sessionId]); //    sessionId\n\n  //    \n  useEffect(() => {\n    if (autoScrollRef.current) {\n      scrollToBottom();\n    }\n  }, [messages]);\n\n  // Screen reader announcements   AI \n  useEffect(() => {\n    if (messages.length > 0) {\n      const lastMessage = messages[messages.length - 1];\n      if (lastMessage.type === 'ai') {\n        const preview = lastMessage.content.substring(0, 100);\n        setAnnouncement(`Assistant: ${preview}${lastMessage.content.length > 100 ? '...' : ''}`);\n      }\n    }\n  }, [messages]);\n\n  // Auto-expand textarea based on content\n  useEffect(() => {\n    if (textareaRef.current) {\n      textareaRef.current.style.height = 'auto';\n      const scrollHeight = textareaRef.current.scrollHeight;\n      textareaRef.current.style.height = `${Math.min(scrollHeight, 120)}px`;\n    }\n  }, [inputMessage]);\n\n  // Mobile keyboard handling - scroll to bottom when keyboard appears\n  useEffect(() => {\n    const handleResize = () => {\n      if (window.visualViewport) {\n        const viewportHeight = window.visualViewport.height;\n        // Keyboard is visible if viewport height is significantly reduced\n        if (viewportHeight < window.innerHeight * 0.7) {\n          scrollToBottom();\n        }\n      }\n    };\n\n    if (window.visualViewport) {\n      window.visualViewport.addEventListener('resize', handleResize);\n      return () => window.visualViewport.removeEventListener('resize', handleResize);\n    }\n  }, []);\n\n  //     -     \n  useEffect(() => {\n    const handleWindowResize = () => {\n      const isMobile = window.innerWidth < 768; // md breakpoint\n      //         - \n      if (!isMobile && !isHistoryCollapsed) {\n        setIsHistoryCollapsed(true);\n      }\n    };\n\n    window.addEventListener('resize', handleWindowResize);\n    return () => window.removeEventListener('resize', handleWindowResize);\n  }, [isHistoryCollapsed]);\n\n  //   body     (  )\n  useEffect(() => {\n    const isMobile = window.innerWidth < 768;\n    if (!isHistoryCollapsed && isMobile) {\n      //   body\n      document.body.style.overflow = 'hidden';\n      return () => {\n        //   \n        document.body.style.overflow = '';\n      };\n    }\n  }, [isHistoryCollapsed]);\n\n  //  Escape    \n  useEffect(() => {\n    const handleEscape = (e) => {\n      if (e.key === 'Escape' && !isHistoryCollapsed && window.innerWidth < 768) {\n        setIsHistoryCollapsed(true);\n      }\n    };\n\n    if (!isHistoryCollapsed && window.innerWidth < 768) {\n      document.addEventListener('keydown', handleEscape);\n      return () => document.removeEventListener('keydown', handleEscape);\n    }\n  }, [isHistoryCollapsed]);\n\n  const handleContainerScroll = () => {\n    //   :       \n    autoScrollRef.current = isNearBottom();\n  };\n\n  //       DOM\n  const showNotificationDirect = (message, description, type = 'success') => {\n    \n    //     \n    const old = document.getElementById('mode-notification-overlay-direct');\n    if (old) old.remove();\n    \n    //   (dark/light)\n    const isDark = document.documentElement.classList.contains('dark') || \n                   window.matchMedia('(prefers-color-scheme: dark)').matches ||\n                   document.body.classList.contains('dark');\n    \n    //     \n    const bgColor = isDark ? '#1f2937' : '#ffffff'; // gray-800 : white\n    const textColor = isDark ? '#f9fafb' : '#111827'; // gray-50 : gray-900\n    const borderColor = isDark ? '#374151' : '#e5e7eb'; // gray-700 : gray-200\n    const overlayBg = isDark ? 'rgba(0, 0, 0, 0.7)' : 'rgba(0, 0, 0, 0.5)';\n    const closeBtnColor = isDark ? '#9ca3af' : '#6b7280'; // gray-400 : gray-500\n    \n    //  HTML \n    const html = `\n      <div id=\"mode-notification-overlay-direct\" style=\"\n        position: fixed !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100vw !important;\n        height: 100vh !important;\n        z-index: 9999999 !important;\n        display: flex !important;\n        align-items: center !important;\n        justify-content: center !important;\n        background-color: ${overlayBg} !important;\n        pointer-events: auto !important;\n      \">\n        <div style=\"\n          background-color: ${bgColor} !important;\n          color: ${textColor} !important;\n          padding: 24px 32px !important;\n          border-radius: 12px !important;\n          border: 1px solid ${borderColor} !important;\n          box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.1) !important;\n          min-width: 380px !important;\n          max-width: 520px !important;\n          display: flex !important;\n          flex-direction: column !important;\n          gap: 12px !important;\n          pointer-events: auto !important;\n        \">\n          <div style=\"display: flex; align-items: center; gap: 16px;\">\n            <div style=\"\n              width: 40px;\n              height: 40px;\n              border-radius: 50%;\n              background-color: ${isDark ? '#374151' : '#f3f4f6'};\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              flex-shrink: 0;\n            \">\n              <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                <path d=\"M10 2L3 7V17H8V12H12V17H17V7L10 2Z\" fill=\"${isDark ? '#60a5fa' : '#3b82f6'}\" />\n              </svg>\n            </div>\n            <div style=\"flex: 1;\">\n              <p style=\"\n                margin: 0;\n                font-size: 16px;\n                font-weight: 600;\n                line-height: 1.5;\n                color: ${textColor};\n              \">${message}</p>\n              ${description ? `<p style=\"\n                margin: 4px 0 0 0;\n                font-size: 13px;\n                font-weight: 400;\n                line-height: 1.4;\n                color: ${isDark ? '#9ca3af' : '#6b7280'};\n              \">${description}</p>` : ''}\n            </div>\n            <button onclick=\"this.closest('#mode-notification-overlay-direct').remove()\" style=\"\n              background: none !important;\n              border: none !important;\n              color: ${closeBtnColor} !important;\n              cursor: pointer !important;\n              padding: 4px !important;\n              font-size: 20px !important;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              flex-shrink: 0;\n            \" aria-label=\"\"></button>\n          </div>\n        </div>\n      </div>\n    `;\n    \n    //   body\n    document.body.insertAdjacentHTML('beforeend', html);\n    \n    //    3 \n    setTimeout(() => {\n      const el = document.getElementById('mode-notification-overlay-direct');\n      if (el) el.remove();\n    }, 3000);\n  };\n\n  //   \n  const handleModeChange = async (newMode) => {\n    if (newMode === chatMode) {\n      setShowModeMenu(false);\n      return;\n    }\n    \n    //    \n    const modeName = newMode === 'basic' ? '' : '';\n    const modeDescription = newMode === 'basic' \n      ? '      '\n      : '    ';\n    showNotificationDirect(`  : ${modeName}`, modeDescription, 'success');\n\n    const cleanSessionId = sessionId ? parseInt(sessionId.toString().replace(/[^0-9]/g, '')) : null;\n    \n    if (!cleanSessionId) {\n      //   ,     (    )\n      setChatMode(newMode);\n      setShowModeMenu(false);\n      return;\n    }\n\n    try {\n      //    API\n      const response = await axios.patch(\n        getApiUrl(`/chat/sessions/${cleanSessionId}/mode`),\n        null,\n        {\n          params: { chat_mode: newMode },\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('token')}`\n          }\n        }\n      );\n\n      if (response.data) {\n        setChatMode(newMode);\n        setShowModeMenu(false);\n      }\n    } catch (error) {\n      console.error('  :', error);\n      showNotificationDirect('    ', '  ', 'error');\n    }\n  };\n\n  //  \n  const sendMessage = async () => {\n    const messageText = inputMessage.trim();\n    if (!messageText || isGenerating) return;\n\n    //  session_id  \n    const cleanSessionId = sessionId ? parseInt(sessionId.toString().replace(/[^0-9]/g, '')) : null;\n\n    const userMessage = {\n      id: `msg_${Date.now()}`,\n      type: 'user',\n      content: messageText,\n      timestamp: new Date().toISOString(),\n      files: attachedFiles\n    };\n\n    setMessages(prev => [...prev, userMessage]);\n    setInputMessage('');\n    setAttachedFiles([]);\n    setIsGenerating(true);\n    setGenerationStartTime(Date.now());\n    setLastError(null);\n\n    try {\n      //    HTTP API, WebSocket     \n      const requestPayload = {\n        message: messageText,\n        session_id: cleanSessionId,\n        set_chat_mode: chatMode  //   \n      };\n      \n      console.log(' :', { \n        message: messageText.substring(0, 50), \n        sessionId: cleanSessionId,\n        url: getApiUrl('/chat/message')\n      });\n      \n      //    SSE (Server-Sent Events)\n      const streamUrl = getApiUrl('/chat/message/stream');\n      const controller = new AbortController();\n      currentStreamRef.current = controller;\n\n      const authToken = localStorage.getItem('token');\n      const resp = await fetch(streamUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'text/event-stream',\n          'Cache-Control': 'no-cache',\n          'Authorization': authToken ? `Bearer ${authToken}` : ''\n        },\n        cache: 'no-store',\n        body: JSON.stringify(requestPayload),\n        signal: controller.signal\n      });\n\n      if (!resp.ok || !resp.body) {\n        const errText = await resp.text().catch(() => '');\n        throw new Error(`Streaming request failed: ${resp.status} ${errText}`);\n      }\n\n      //   AI-   \n      const aiMsgId = `ai_${Date.now()}`;\n      setMessages(prev => [...prev, { id: aiMsgId, type: 'ai', content: '', timestamp: new Date().toISOString() }]);\n\n      const reader = resp.body.getReader();\n      const decoder = new TextDecoder('utf-8');\n      let buffer = '';\n\n      const applyChunk = (text) => {\n        setMessages(prev => prev.map(m => m.id === aiMsgId ? { ...m, content: (m.content || '') + text } : m));\n      };\n\n      while (true) {\n        const { value, done } = await reader.read();\n        if (done) break;\n        buffer += decoder.decode(value, { stream: true });\n        const lines = buffer.split(/\\n\\n/);\n        buffer = lines.pop() || '';\n        for (const block of lines) {\n          //   SSE:   \"data: {json}\"\n          const dataLine = block.split('\\n').find(l => l.startsWith('data:'));\n          if (!dataLine) continue;\n          const payload = dataLine.replace(/^data:\\s?/, '');\n          try {\n            const evt = JSON.parse(payload);\n            if (evt.type === 'start' && evt.session_id) {\n              //  sessionId     (   )\n              console.log(' session_id  :', evt.session_id, ':', sessionId);\n              if (!sessionId || sessionId !== evt.session_id) {\n                setSessionId(evt.session_id);\n                console.log(' sessionId :', evt.session_id);\n              }\n            } else if (evt.type === 'chunk' && typeof evt.content === 'string') {\n              applyChunk(evt.content);\n            } else if (evt.type === 'end') {\n              // \n            } else if (evt.type === 'error') {\n              throw new Error(evt.content || 'stream error');\n            }\n          } catch (_) {\n            //      \n            applyChunk(payload);\n          }\n        }\n      }\n\n      setIsGenerating(false);\n      setGenerationStartTime(null);\n    } catch (error) {\n      console.error('  :', error);\n      \n      //       ,   \n      const isAborted = (currentStreamRef.current && currentStreamRef.current.signal?.aborted) \n        || error?.name === 'AbortError' \n        || String(error?.message || error).toLowerCase().includes('aborted');\n      \n      setIsGenerating(false);\n      setGenerationStartTime(null);\n      \n      if (isAborted) {\n        showGenerationStopped();\n        return; //       \n      }\n      \n      setLastError(error);\n      \n      //         \n      // -   ,     \n      console.error('  :', error);\n      \n      //   -      \n      if (!isAborted) {\n        showError(error, {\n          autoHide: false,\n          actions: [\n            {\n              label: '',\n              action: () => sendMessage(),\n              primary: true\n            }\n          ]\n        });\n      }\n      \n      //         \n      let errorText = '    .';\n      \n      //       \n      const errorMessage = String(error?.message || error || '').toLowerCase();\n      if (errorMessage.includes('timeout') || errorMessage.includes('[timeout]')) {\n        errorText = '    (300 ).    . :\\n  \\n      \\n  ,      ';\n      } else if (error.response) {\n        const status = error.response.status;\n        const data = error.response.data;\n        \n        if (status === 408) {\n          errorText = '   .        .';\n        } else if (status === 503) {\n          errorText = '  .     .';\n        } else if (status === 401) {\n          errorText = ' . ,  .';\n        } else if (status === 429) {\n          errorText = '  .     .';\n        } else if (status >= 500) {\n          errorText = ' .      .';\n        } else if (data?.detail || data?.message) {\n          errorText = data.detail || data.message;\n        }\n      } else if (error.request) {\n        errorText = '    .    .';\n      }\n      \n      const errorMsg = {\n        id: `error_${Date.now()}`,\n        type: 'error',\n        content: errorText,\n        timestamp: new Date().toISOString(),\n        error: error\n      };\n      setMessages(prev => [...prev, errorMsg]);\n    }\n  };\n\n  //  \n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n  };\n\n  //        (  )\n  useEffect(() => {\n    const handleClickOutside = (e) => {\n      //        \n      if (window.innerWidth >= 768 && isInputExpanded) {\n        const inputArea = e.target.closest('[data-input-area]');\n        if (!inputArea) {\n          setIsInputExpanded(false);\n        }\n      }\n    };\n\n    if (isInputExpanded && window.innerWidth >= 768) {\n      document.addEventListener('mousedown', handleClickOutside);\n      return () => document.removeEventListener('mousedown', handleClickOutside);\n    }\n  }, [isInputExpanded]);\n\n  //       \n  useEffect(() => {\n    const handleClickOutside = (e) => {\n      if (modeMenuRef.current && !modeMenuRef.current.contains(e.target)) {\n        setShowModeMenu(false);\n      }\n    };\n\n    if (showModeMenu) {\n      document.addEventListener('mousedown', handleClickOutside);\n      return () => document.removeEventListener('mousedown', handleClickOutside);\n    }\n  }, [showModeMenu]);\n\n  return (\n    <div className=\"flex h-full bg-gray-50 dark:bg-gray-900 overflow-x-hidden\">\n      {/*     -   ,    */}\n      <div className={`hidden md:flex md:flex-col md:h-full ${isHistoryCollapsed ? 'w-16' : 'w-80'} transition-all duration-300 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 flex-shrink-0 overflow-hidden`}>\n        <ChatHistory \n          isCollapsed={isHistoryCollapsed}\n          onToggle={() => {\n            setIsHistoryCollapsed(!isHistoryCollapsed);\n            setFocusHistorySearch(false);\n          }}\n          onToggleCollapse={() => {\n            setIsHistoryCollapsed(!isHistoryCollapsed);\n            setFocusHistorySearch(false);\n          }}\n          currentSessionId={sessionId}\n          onSessionSelect={(id) => {\n            console.log('onSessionSelect   id:', id, ' sessionId:', sessionId);\n            setSessionId(id);\n          }}\n          onNewChat={(newSessionId) => {\n            setSessionId(newSessionId);\n            //     useEffect   sessionId\n          }}\n          focusSearch={focusHistorySearch}\n        />\n      </div>\n\n      {/*      */}\n      {!isHistoryCollapsed && (\n        <div \n          className=\"md:hidden fixed inset-0 z-[60] flex\" \n          style={{ zIndex: 60 }}\n        >\n          {/* Overlay */}\n          <div \n            className=\"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-300\"\n            onClick={(e) => {\n              e.preventDefault();\n              e.stopPropagation();\n              setIsHistoryCollapsed(true);\n            }}\n          />\n          {/*  */}\n          <div \n            className=\"relative w-full max-w-[320px] bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transform transition-transform duration-300 ease-out z-[61] shadow-2xl\"\n            onClick={(e) => e.stopPropagation()}\n            style={{ zIndex: 61 }}\n          >\n            <div className=\"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between bg-white dark:bg-gray-800\">\n              <h2 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100\"> </h2>\n              <button\n                onClick={(e) => {\n                  e.preventDefault();\n                  e.stopPropagation();\n                  setIsHistoryCollapsed(true);\n                }}\n                className=\"p-3 min-h-[44px] min-w-[44px] text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-all flex items-center justify-center touch-manipulation shadow-sm hover:shadow-md flex-shrink-0\"\n                aria-label=\" \"\n                title=\" \"\n                type=\"button\"\n              >\n                <ChevronLeft className=\"w-6 h-6\" />\n              </button>\n            </div>\n            <ChatHistory \n              isCollapsed={false}\n              hideHeader={true}\n              onToggle={() => {\n                setIsHistoryCollapsed(true);\n                setFocusHistorySearch(false);\n              }}\n              onToggleCollapse={() => {\n                setIsHistoryCollapsed(true);\n                setFocusHistorySearch(false);\n              }}\n              currentSessionId={sessionId}\n              onSessionSelect={(id) => {\n                console.log('onSessionSelect ( )   id:', id, ' sessionId:', sessionId);\n                setSessionId(id);\n                setIsHistoryCollapsed(true);\n                setFocusHistorySearch(false);\n              }}\n              onNewChat={(newSessionId) => {\n                setSessionId(newSessionId);\n                //     useEffect   sessionId\n                setIsHistoryCollapsed(true);\n                setFocusHistorySearch(false);\n              }}\n              focusSearch={focusHistorySearch}\n            />\n          </div>\n        </div>\n      )}\n\n      {/*   -     */}\n      <div className=\"flex-1 flex flex-col overflow-hidden overflow-x-hidden min-w-0 max-w-full\">\n        {/*  */}\n        <div className=\"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 sm:px-6 py-4 flex-shrink-0\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              {/*      */}\n              <button\n                onClick={(e) => {\n                  e.preventDefault();\n                  e.stopPropagation();\n                  setIsHistoryCollapsed(prev => !prev);\n                }}\n                className=\"md:hidden p-2.5 min-w-[44px] min-h-[44px] text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-all flex items-center justify-center touch-manipulation shadow-sm hover:shadow-md\"\n                aria-label=\" \"\n                title=\" \"\n                type=\"button\"\n              >\n                <History className=\"w-5 h-5\" />\n              </button>\n              <div className=\"w-10 h-10 bg-blue-600 dark:bg-primary-500 rounded-full flex items-center justify-center neon-glow-purple\">\n                <Bot className=\"w-6 h-6 text-white\" />\n              </div>\n              <div>\n                <h1 className=\"text-xl font-semibold text-gray-900 dark:text-gray-100\">  </h1>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1 hidden sm:block\">  AI -</p>\n              </div>\n            </div>\n            \n            <div className=\"flex items-center space-x-2\">\n              {/*      */}\n              {(!isConnected && connectionState === 'failed') && (\n                <button\n                  onClick={forceReconnect}\n                  className=\"flex items-center space-x-1 px-3 py-1 text-sm bg-blue-600 dark:bg-primary-600 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-primary-700 transition-colors neon-button-primary\"\n                  title=\"  \"\n                >\n                  <RefreshCw className=\"w-4 h-4\" />\n                  <span className=\"hidden sm:inline\"></span>\n                </button>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/*   -  */}\n        <div\n          className=\"flex-1 overflow-y-auto overflow-x-hidden p-3 sm:p-6 space-y-4 dark:bg-gray-900 min-h-0\"\n          ref={messagesContainerRef}\n          onScroll={handleContainerScroll}\n          role=\"log\"\n          aria-live=\"polite\"\n          aria-label=\"Chat messages\"\n        >\n          {messages.map((message) => (\n            <div key={message.id} className={`flex ${message.type === 'user' ? 'justify-end' : 'justify-start'}`}>\n              <div className={`${message.type === 'user' ? 'max-w-[85%] md:max-w-[80%] ml-auto' : 'w-full'}`}>\n                <div className={`flex items-start space-x-3 ${message.type === 'user' ? 'flex-row-reverse space-x-reverse' : ''}`}>\n                  <div className={`w-[35px] h-[35px] md:w-10 md:h-10 rounded-full flex items-center justify-center ${\n                    message.type === 'user' ? 'bg-blue-600 dark:bg-primary-600 neon-glow-cyan' : 'bg-gray-600 dark:bg-gray-700 neon-glow-purple'\n                  }`}>\n                    {message.type === 'user' ? (\n                      <User className=\"w-[18px] h-[18px] md:w-5 md:h-5 text-white\" />\n                    ) : (\n                      <Bot className=\"w-[18px] h-[18px] md:w-5 md:h-5 text-white\" />\n                    )}\n                  </div>\n                  \n                  <div className={`${\n                    message.type === 'user' \n                      ? 'px-4 py-3 rounded-lg bg-blue-600 dark:bg-primary-600 text-white neon-card' \n                      : message.type === 'error'\n                      ? ''\n                      : 'px-4 py-3 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700 neon-glass-card'\n                  }`}>\n                    {message.type === 'error' ? (\n                      <ErrorMessage\n                        error={message.error || message.content}\n                        onRetry={() => {\n                          //   \n                          const lastUserMessage = messages.slice().reverse().find(m => m.type === 'user');\n                          if (lastUserMessage) {\n                            setInputMessage(lastUserMessage.content);\n                          }\n                        }}\n                        onReconnect={forceReconnect}\n                        variant=\"default\"\n                      />\n                    ) : (\n                      <>\n                        <EnhancedResponse message={message} />\n                        <div className=\"flex items-center justify-between mt-3\">\n                          <div className=\"text-xs opacity-70\">\n                            {new Date(message.timestamp).toLocaleTimeString()}\n                          </div>\n                          {message.type === 'ai' && message.id === 'welcome' && (\n                            <FeedbackButtons messageId={message.id} />\n                          )}\n                        </div>\n                      </>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </div>\n          ))}\n          \n          {isGenerating && (\n            <div className=\"flex justify-start\">\n              <div className=\"w-full\">\n                <div className=\"flex items-start space-x-3\">\n                  <div className=\"w-[35px] h-[35px] md:w-10 md:h-10 rounded-full bg-gray-600 flex items-center justify-center\">\n                    <Bot className=\"w-[18px] h-[18px] md:w-5 md:h-5 text-white\" />\n                  </div>\n                  <div className=\"flex-1\">\n                    <AIThinkingIndicator\n                      isGenerating={isGenerating}\n                      startTime={generationStartTime}\n                      onStop={stopGeneration}\n                      variant=\"default\"\n                      estimatedTime={120} // 2   \n                    />\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n          \n          <div ref={messagesEndRef} />\n        </div>\n\n        {/*   -  ,   */}\n        <div \n          ref={inputAreaRef}\n          data-input-area\n          className=\"bg-transparent p-3 sm:p-4 md:p-6 flex-shrink-0 z-40 transition-all duration-300 safe-bottom\"\n          style={{\n            paddingBottom: 'max(12px, env(safe-area-inset-bottom, 0px))'\n          }}\n          onMouseEnter={() => {\n            if (window.innerWidth >= 768) {\n              setIsInputExpanded(true);\n            }\n          }}\n          onMouseLeave={() => {\n            if (window.innerWidth >= 768) {\n              setIsInputExpanded(false);\n            }\n          }}\n          onTouchStart={() => {\n            //        \n            if (window.innerWidth < 768) {\n              setIsInputExpanded(true);\n            }\n          }}\n        >\n          {/*   placeholder -       */}\n          <style>{`\n            #chat-input-textarea {\n              text-align: left;\n            }\n            #chat-input-textarea::placeholder {\n              text-align: left;\n            }\n          `}</style>\n          {/*   */}\n          {attachedFiles.length > 0 && (\n            <div className=\"mb-3 flex flex-wrap gap-2\">\n              {attachedFiles.map((file, index) => (\n                <div key={index} className=\"flex items-center space-x-2 bg-gray-100 dark:bg-gray-700 px-3 py-2 rounded-xl\">\n                  <File className=\"w-4 h-4 text-gray-600 dark:text-gray-300\" />\n                  <span className=\"text-sm text-gray-700 dark:text-gray-300\">{file.name}</span>\n                  <button\n                    onClick={() => setAttachedFiles(prev => prev.filter((_, i) => i !== index))}\n                    className=\"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200\"\n                  >\n                    <X className=\"w-4 h-4\" />\n                  </button>\n                </div>\n              ))}\n            </div>\n          )}\n\n          {/*   -    ( 3) */}\n          {isInputExpanded && (\n            <div className=\"flex items-center gap-2 mb-3 animate-slide-in-up overflow-x-auto -mx-3 sm:-mx-4 px-3 sm:px-4\">\n              <button\n                onClick={() => setShowFileUpload(!showFileUpload)}\n                className=\"flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 hover:bg-primary-50 dark:hover:bg-primary-900/20 rounded-xl transition-all min-h-[44px] touch-manipulation flex-shrink-0 whitespace-nowrap\"\n                title=\" \"\n                aria-label=\"Attach file\"\n              >\n                <Paperclip className=\"w-4 h-4 flex-shrink-0\" />\n                <span className=\"hidden sm:inline\"></span>\n              </button>\n              <button\n                onClick={() => setShowTemplates(!showTemplates)}\n                className=\"flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 hover:bg-primary-50 dark:hover:bg-primary-900/20 rounded-xl transition-all min-h-[44px] touch-manipulation flex-shrink-0 whitespace-nowrap\"\n                title=\" \"\n                aria-label=\"Question templates\"\n              >\n                <Lightbulb className=\"w-4 h-4 flex-shrink-0\" />\n                <span className=\"hidden sm:inline\"></span>\n              </button>\n            </div>\n          )}\n\n          {/*    */}\n          <div className=\"flex items-center gap-2 sm:gap-3\">\n            {/*     -  ,     */}\n            <div className=\"relative\" ref={modeMenuRef}>\n              <button\n                onClick={() => setShowModeMenu(!showModeMenu)}\n                className=\"h-[48px] w-[48px] sm:h-[52px] sm:w-[52px] bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600 hover:text-primary-600 dark:hover:text-primary-400 rounded-xl transition-all flex items-center justify-center touch-manipulation shadow-md hover:shadow-lg flex-shrink-0 border border-gray-200 dark:border-gray-600\"\n                title=\" \"\n                aria-label=\"Mode settings\"\n              >\n                <Settings className=\"w-5 h-5 sm:w-6 sm:h-6\" />\n              </button>\n              \n              {/*    */}\n              {showModeMenu && (\n                <>\n                  <div \n                    className=\"fixed inset-0 z-40\" \n                    onClick={() => setShowModeMenu(false)}\n                  />\n                  <div \n                    className=\"absolute bottom-full left-0 mb-2 w-72 bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 py-2 z-50\"\n                    onClick={(e) => e.stopPropagation()}\n                  >\n                    <div className=\"px-4 py-2 border-b border-gray-200 dark:border-gray-700\">\n                      <h3 className=\"text-sm font-semibold text-gray-900 dark:text-gray-100\"> </h3>\n                    </div>\n                    \n                    {/*   */}\n                    <button\n                      onClick={(e) => {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        handleModeChange('basic').catch(err => console.error(':', err));\n                      }}\n                      className=\"w-full px-4 py-3 text-left hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors\"\n                    >\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center gap-2\">\n                            <span className=\"text-sm font-medium text-gray-900 dark:text-gray-100\"></span>\n                            {chatMode === 'basic' && (\n                              <Check className=\"w-4 h-4 text-primary-600 dark:text-primary-400\" />\n                            )}\n                          </div>\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                                  ,   .\n                          </p>\n                        </div>\n                      </div>\n                    </button>\n                    \n                    {/*   */}\n                    <button\n                      onClick={(e) => {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        handleModeChange('expert').catch(err => console.error(':', err));\n                      }}\n                      className=\"w-full px-4 py-3 text-left hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors border-t border-gray-200 dark:border-gray-700\"\n                    >\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center gap-2\">\n                            <span className=\"text-sm font-medium text-gray-900 dark:text-gray-100\"></span>\n                            {chatMode === 'expert' && (\n                              <Check className=\"w-4 h-4 text-primary-600 dark:text-primary-400\" />\n                            )}\n                          </div>\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                                   \n                          </p>\n                        </div>\n                      </div>\n                    </button>\n                  </div>\n                </>\n              )}\n            </div>\n            \n            {/*         ( 3) */}\n            <div className=\"flex-1 relative min-w-0\">\n              <div \n                className={`\n                  rounded-3xl\n                  border-[3px] sm:border-[4px]\n                  border-primary-500 dark:border-primary-600\n                  bg-white dark:bg-gray-700\n                  backdrop-blur-xl\n                  transition-all duration-300\n                  flex items-center\n                  ${isInputExpanded \n                    ? 'shadow-[0_0_30px_rgba(37,99,235,0.5),0_10px_40px_rgba(0,0,0,0.3)] border-primary-600 dark:border-primary-500 ring-4 ring-primary-500/20 dark:ring-primary-600/20' \n                    : 'shadow-[0_4px_20px_rgba(0,0,0,0.15),0_8px_30px_rgba(0,0,0,0.1)] border-primary-500 dark:border-primary-600'\n                  }\n                `}\n                style={{ height: '48px', minHeight: '48px' }}\n              >\n                <textarea\n                  ref={textareaRef}\n                  id=\"chat-input-textarea\"\n                  value={inputMessage}\n                  onChange={(e) => setInputMessage(e.target.value)}\n                  onKeyPress={handleKeyPress}\n                  onFocus={() => {\n                    setIsInputExpanded(true);\n                  }}\n                  onTouchStart={() => {\n                    setIsInputExpanded(true);\n                  }}\n                  onBlur={(e) => {\n                    //      blur,   \n                    if (window.innerWidth >= 768) {\n                      const relatedTarget = e.relatedTarget;\n                      if (!relatedTarget || !relatedTarget.closest('[data-input-area]')) {\n                        setTimeout(() => {\n                          if (document.activeElement !== textareaRef.current) {\n                            setIsInputExpanded(false);\n                          }\n                        }, 200);\n                      }\n                    }\n                  }}\n                  placeholder=\"  ...\"\n                  className=\"\n                    w-full px-3 sm:px-4\n                    bg-transparent\n                    text-gray-900 dark:text-gray-100\n                    placeholder-gray-500 dark:placeholder-gray-400\n                    text-base\n                    transition-all duration-300\n                    focus:outline-none\n                    focus:ring-0\n                    resize-none\n                    leading-normal\n                    border-0\n                    overflow-hidden\n                  \"\n                  style={{\n                    height: '100%',\n                    paddingTop: '10px',\n                    paddingBottom: '10px',\n                    lineHeight: '20px',\n                    verticalAlign: 'middle',\n                    maxHeight: '48px'\n                  }}\n                  rows={1}\n                  disabled={isGenerating}\n                  aria-label=\"Type your message\"\n                  aria-describedby=\"input-help\"\n                />\n              </div>\n              <span id=\"input-help\" className=\"sr-only\">\n                Press Enter to send, Shift+Enter for new line\n              </span>\n            </div>\n            \n            {/*    -  ,     */}\n            <button\n              onClick={() => setShowVoiceRecorder(!showVoiceRecorder)}\n              className=\"h-[48px] w-[48px] sm:h-[52px] sm:w-[52px] bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600 hover:text-primary-600 dark:hover:text-primary-400 rounded-xl transition-all flex items-center justify-center touch-manipulation shadow-md hover:shadow-lg flex-shrink-0 border border-gray-200 dark:border-gray-600\"\n              title=\" \"\n              aria-label=\"Voice input\"\n            >\n              <Mic className=\"w-5 h-5 sm:w-6 sm:h-6\" />\n            </button>\n            \n            {/*   -      */}\n            {inputMessage.trim() && (\n              <button\n                onClick={sendMessage}\n                disabled={!inputMessage.trim() || isGenerating}\n                className=\"h-[48px] w-[48px] sm:h-[52px] sm:w-[52px] p-2.5 sm:p-3 bg-primary-600 text-white rounded-xl hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center shadow-lg touch-manipulation flex-shrink-0\"\n                title=\" \"\n                aria-label=\"Send message\"\n              >\n                <Send className=\"w-5 h-5\" />\n              </button>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/*   */}\n      {showFileUpload && (\n        <LazyFileUpload\n          onClose={() => setShowFileUpload(false)}\n          onFilesSelected={(files) => setAttachedFiles(prev => [...prev, ...files])}\n        />\n      )}\n      \n      {showTemplates && (\n        <LazyQuestionTemplates\n          isVisible={showTemplates}\n          onClose={() => setShowTemplates(false)}\n          onTemplateSelect={(template) => {\n            setInputMessage(template);\n            setShowTemplates(false);\n          }}\n        />\n      )}\n      \n      {showVoiceRecorder && (\n        <VoiceRecorder\n          onClose={() => setShowVoiceRecorder(false)}\n          onRecordingComplete={(audioBlob) => {\n            //   \n            console.log('Audio recorded:', audioBlob);\n          }}\n        />\n      )}\n\n      {/*     (   ) */}\n      <StatusNotificationSystem\n        websocket={websocket}\n        isGenerating={false}\n        generationStartTime={generationStartTime}\n        onStopGeneration={stopGeneration}\n        onReconnect={forceReconnect}\n        onForceReconnect={forceReconnect}\n      />\n\n\n      {/* Screen reader announcements */}\n      <div \n        role=\"status\" \n        aria-live=\"polite\" \n        aria-atomic=\"true\" \n        className=\"sr-only\"\n      >\n        {announcement}\n      </div>\n    </div>\n  );\n};\n\nexport default Chat;\n"],"names":["constructor","url","options","arguments","length","undefined","this","_objectSpread","maxReconnectAttempts","reconnectDelay","maxReconnectDelay","pingInterval","pongTimeout","connectionTimeout","maxMessageSize","enableHeartbeat","enableAutoReconnect","enableErrorRecovery","ws","reconnectAttempts","isConnected","isConnecting","shouldReconnect","listeners","Map","lastPong","messageQueue","maxQueueSize","connectionStats","totalConnections","totalReconnections","totalMessages","totalErrors","lastConnectedAt","lastDisconnectedAt","connectionDuration","averageLatency","errorRate","connectionState","errorRecovery","consecutiveErrors","lastErrorTime","errorTypes","recoveryStrategies","initializeRecoveryStrategies","set","maxAttempts","delay","action","async","console","log","emit","navigator","onLine","connect","Promise","resolve","reject","WebSocket","connectTimeout","setTimeout","readyState","CONNECTING","close","Error","onopen","clearTimeout","Date","startPingPong","flushMessageQueue","onmessage","event","data","JSON","parse","type","handlePong","error","onclose","code","reason","stopPingPong","handleClose","scheduleReconnect","onerror","now","errorType","classifyError","handleErrorRecovery","recoverable","isErrorRecoverable","disconnect","send","message","stringify","size","maxSize","OPEN","queueMessage","catch","originalError","queued","shift","push","unshift","includes","strategy","get","warn","concat","errorCount","attempts","attempt","recoveryError","waitForNetworkRecovery","baseDelay","Math","min","pow","attemptReconnect","clear","checkNetwork","window","removeEventListener","addEventListener","intervalCheck","setInterval","clearInterval","pingData","timestamp","on","callback","has","Set","add","off","delete","_len","args","Array","_key","forEach","getStatus","connected","connecting","CLOSED","queuedMessages","stats","getUserFriendlyStatus","statusMap","text","color","icon","reconnect","resetErrorRecovery","checkConnectionHealth","health","timeSinceLastPong","networkOnline","isHealthy","getRecoveryRecommendations","recommendations","applyRecoveryRecommendation","useStatusNotifications","showError","useCallback","statusNotifications","showSuccess","showInfo","info","showModelUnavailable","removeNotification","id","showConnectionError","title","autoHide","actions","label","location","reload","primary","showAuthError","href","showGenerationStopped","duration","showGenerationTimeout","_ref","onSendVoiceMessage","onCancel","maxDuration","isRecording","setIsRecording","useState","isPaused","setIsPaused","recordingTime","setRecordingTime","audioBlob","setAudioBlob","audioUrl","setAudioUrl","isPlaying","setIsPlaying","volume","setVolume","isMuted","setIsMuted","setError","mediaRecorderRef","useRef","audioRef","streamRef","timerRef","chunksRef","isDark","useTheme","useEffect","current","getTracks","track","stop","URL","revokeObjectURL","stopRecording","audio","handleEnded","handlePlay","handlePause","formatTime","seconds","mins","floor","secs","toString","padStart","_jsxs","className","children","_jsx","ref","src","onVolumeChange","e","target","map","_","i","style","height","random","animationDelay","onClick","mediaDevices","getUserMedia","stream","echoCancellation","noiseSuppression","sampleRate","mediaRecorder","MediaRecorder","mimeType","ondataavailable","onstop","blob","Blob","createObjectURL","start","prev","err","Mic","_Fragment","togglePause","resume","pause","Play","Pause","Square","togglePlayback","play","VolumeX","Volume2","sendVoiceMessage","Send","cancelRecording","Trash2","toFixed","width","currentSessionId","onSessionSelect","onNewChat","isCollapsed","onToggleCollapse","focusSearch","hideHeader","sessions","setSessions","loading","setLoading","editingSession","setEditingSession","editTitle","setEditTitle","showEmptyChats","setShowEmptyChats","searchQuery","setSearchQuery","searchResults","setSearchResults","isSearching","setIsSearching","sessionMessages","setSessionMessages","searchInputRef","React","loadSessions","response","axios","getApiUrl","params","include_empty","sortedSessions","sort","a","b","dateA","updated_at","created_at","handleNewChat","newSession","post","toLocaleDateString","saveTitle","put","sessionId","trim","s","cancelEditing","formatDate","dateString","date","diffDays","toLocaleTimeString","hour","minute","day","month","truncateTitle","maxLength","substring","searchInHistory","query","lowerQuery","toLowerCase","results","titleMatches","filter","session","sessionTitle","matchType","matchText","find","messages","messageMatches","msg","content","matchCount","timeoutId","_searchInputRef$curre","focus","filteredSessions","useMemo","matchedSessionIds","r","preventDefault","stopPropagation","ChevronRight","ChevronLeft","Plus","searchMatch","MessageSquare","value","onChange","onKeyPress","key","autoFocus","Check","X","last_message_preview","Clock","last_message_time","startEditing","Edit3","confirm","handleDeleteSession","Search","onFocus","placeholder","display","Calendar","confirmMessage","handleClearAllHistory","Eraser","enhancements","showDetails","setShowDetails","showSources","setShowSources","showWarnings","setShowWarnings","messageEnhancements","factChecking","fact_checking","explainability","rawQuality","overall_quality","overallQuality","hasQualityRating","qualityInfo","quality","level","bg","formatMetric","ReactMarkdown","remarkPlugins","remarkGfm","components","h1","_ref2","node","props","_objectWithoutProperties","_excluded","h2","_ref3","_excluded2","h3","_ref4","_excluded3","h4","_ref5","_excluded4","p","_ref6","_excluded5","strong","_ref7","_excluded6","em","_ref8","_excluded7","ul","_ref9","_excluded8","ol","_ref0","_excluded9","li","_ref1","_excluded0","_ref10","inline","_excluded1","blockquote","_ref11","_excluded10","_ref12","_excluded11","rel","hr","_ref13","_excluded12","table","_ref14","_excluded13","th","_ref15","_excluded14","td","_ref16","_excluded15","Shield","Object","keys","Target","ChevronUp","ChevronDown","sources","FileText","warnings","AlertTriangle","citation_recall","support_coverage","hallucination_score","legal_consistency","source","index","article","part","item","edition","excerpt","ExternalLink","relevance_score","round","warning","user_actions","Lightbulb","CheckCircle","argument","confidence","metadata","toLocaleString","sources_count","messageId","onFeedbackSubmitted","feedback","setFeedback","showReasonModal","setShowReasonModal","selectedReason","setSelectedReason","comment","setComment","isSubmitting","setIsSubmitting","ThumbsUp","ThumbsDown","token","localStorage","getItem","process","message_id","rating","headers","Authorization","alert","disabled","handleNegativeFeedback","name","checked","rows","onRetry","onReconnect","showIcon","variant","errorInfo","_error$response","_error$message","_error$message2","AlertCircle","WifiOff","Server","Zap","status","request","getErrorInfo","Icon","getColorClasses","colorMap","red","orange","yellow","blue","getButtonColorClasses","renderActions","RefreshCw","Wifi","open","isGenerating","onStop","startTime","estimatedTime","elapsedTime","setElapsedTime","thinkingPhase","setThinkingPhase","thinkingPhases","Brain","Bot","interval","elapsed","phase","currentPhase","PhaseIcon","motion","div","animate","rotate","transition","repeat","Infinity","ease","AnimatePresence","mode","span","initial","opacity","y","exit","x","_websocket$options2","websocket","onForceReconnect","setStatus","isVisible","setIsVisible","showDetailedInfo","setShowDetailedInfo","lastError","setLastError","reconnectCountdown","setReconnectCountdown","updateStatus","currentStatus","userStatus","handleStateChange","state","handleError","startCountdown","_websocket$options","actualDelay","ceil","countdownInterval","handleReconnectClick","getStatusColor","getStatusIcon","Activity","StatusNotification","notification","onClose","styles","success","getNotificationStyles","generationStartTime","onStopGeneration","notifications","setNotifications","connectionError","setConnectionError","modelError","setModelError","lastNotificationRef","debounceTimersRef","n","addNotification","notificationKey","lastShown","timerId","newNotification","values","timer","stateChangeTimer","errorTimer","lastState","errorNotification","AIThinkingIndicator","EnhancedConnectionStatus","scale","Chat","setMessages","inputMessage","setInputMessage","setIsGenerating","setGenerationStartTime","setSessionId","attachedFiles","setAttachedFiles","showFileUpload","setShowFileUpload","showTemplates","setShowTemplates","showVoiceRecorder","setShowVoiceRecorder","isInputExpanded","setIsInputExpanded","showModeMenu","setShowModeMenu","chatMode","setChatMode","modeNotification","setModeNotification","inputAreaRef","modeMenuRef","isHistoryCollapsed","setIsHistoryCollapsed","innerWidth","focusHistorySearch","setFocusHistorySearch","messagesEndRef","messagesContainerRef","textareaRef","autoScrollRef","currentStreamRef","initializedRef","announcement","setAnnouncement","scrollToBottom","el","scrollTop","scrollHeight","stopGeneration","handleNewMessage","messageData","aiMessage","toISOString","sendChatMessage","wsSendChatMessage","wsStopGeneration","forceReconnect","useChatWebSocket","onNewMessage","onTyping","onSessionUpdate","user","useAuth","typingTimeoutRef","isTypingRef","websocketRef","setIsConnected","setConnectionState","createWebSocket","cleanSessionId","String","replace","wsBaseUrl","ResilientWebSocket","user_id","is_typing","sendMessage","payload","session_id","sendTyping","isTyping","joinSession","newSessionId","abort","caches","then","cacheNames","cacheName","apiUrl","messagesData","_sessionResponse$data","sessionResponse","chat_mode","formattedMessages","role","_error$response2","_error$response3","_error$response3$data","detail","loadSessionMessages","lastMessage","preview","handleResize","visualViewport","innerHeight","handleWindowResize","isMobile","document","body","overflow","handleEscape","showNotificationDirect","description","old","getElementById","remove","documentElement","classList","contains","matchMedia","matches","bgColor","textColor","borderColor","closeBtnColor","html","insertAdjacentHTML","handleModeChange","newMode","modeDescription","parseInt","patch","messageText","userMessage","files","requestPayload","set_chat_mode","streamUrl","controller","AbortController","authToken","resp","fetch","method","cache","signal","ok","errText","aiMsgId","reader","getReader","decoder","TextDecoder","buffer","applyChunk","m","done","read","decode","lines","split","pop","block","dataLine","l","startsWith","evt","_currentStreamRef$cur","isAborted","aborted","errorText","errorMessage","errorMsg","handleClickOutside","closest","ChatHistory","onToggle","zIndex","History","onScroll","handleContainerScroll","isNearBottom","clientHeight","User","ErrorMessage","lastUserMessage","slice","reverse","EnhancedResponse","FeedbackButtons","paddingBottom","onMouseEnter","onMouseLeave","onTouchStart","file","File","Paperclip","Settings","minHeight","shiftKey","onBlur","relatedTarget","activeElement","paddingTop","lineHeight","verticalAlign","maxHeight","LazyFileUpload","onFilesSelected","LazyQuestionTemplates","onTemplateSelect","template","VoiceRecorder","onRecordingComplete","StatusNotificationSystem"],"sourceRoot":""}