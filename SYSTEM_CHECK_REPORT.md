# –û—Ç—á–µ—Ç –æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ —Å–∏—Å—Ç–µ–º—ã –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 18 –Ω–æ—è–±—Ä—è 2025, 02:27 MSK  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞

## –†–µ–∑—é–º–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –ú–∏–≥—Ä–∞—Ü–∏—è PostgreSQL –∏ Nginx –Ω–∞ —Ö–æ—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ, –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ.

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. PostgreSQL –Ω–∞ —Ö–æ—Å—Ç–µ
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ Active (running)
- **–í–µ—Ä—Å–∏—è**: PostgreSQL 16.10
- **–ü–æ—Ä—Ç**: 5432 (—Å–ª—É—à–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: advakod_db
- **–î–∞–Ω–Ω—ã–µ**: 
  - 3 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - 64 —Ç–∞–±–ª–∏—Ü—ã
  - –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é
- **–î–æ—Å—Ç—É–ø –∏–∑ Docker**: ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ `host.docker.internal`
- **–ü—Ä–∞–≤–∏–ª–∞ –¥–æ—Å—Ç—É–ø–∞**: –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è —Å–µ—Ç–µ–π 172.17.0.0/16, 172.18.0.0/16, 172.19.0.0/16, 172.20.0.0/16
- **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫**: ‚úÖ Enabled
- **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö**: 67MB
- **–ü–∞–º—è—Ç—å**: 271MB RSS

### 2. Nginx –Ω–∞ —Ö–æ—Å—Ç–µ
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ Active (running)
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: ‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
- **–ü–æ—Ä—Ç—ã**: 80, 443 (HTTP/2 –≤–∫–ª—é—á–µ–Ω)
- **SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç**: ‚úÖ –í–∞–ª–∏–¥–µ–Ω –¥–æ 20 —è–Ω–≤–∞—Ä—è 2026
- **Upstream backend**: 127.0.0.1:8000 ‚úÖ
- **Upstream frontend**: 127.0.0.1:3001 ‚úÖ
- **–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫**: ‚úÖ Enabled
- **–ü–∞–º—è—Ç—å**: 11.4MB

### 3. Backend (Docker)
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä**: advakod_backend
- **–°—Ç–∞—Ç—É—Å**: Running (unhealthy –≤ healthcheck, –Ω–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω)
- **–ü–æ—Ä—Ç**: 8000
- **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î**: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ `host.docker.internal:5432`
- **API Health**: ‚úÖ `/api/v1/health` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 200 OK
- **–í–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø**: ‚úÖ https://advacodex.com/api/v1/health —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**: ‚úÖ DATABASE_URL –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### 4. Frontend (Docker)
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä**: advakod_frontend
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ Running
- **–ü–æ—Ä—Ç**: 3001

### 5. Redis (Docker)
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä**: advakod_redis
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ Healthy
- **–ü–æ—Ä—Ç**: 6379
- **–¢–µ—Å—Ç**: ‚úÖ PONG

### 6. Qdrant (Docker)
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä**: advakod_qdrant
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ Running
- **–ü–æ—Ä—Ç—ã**: 6333, 6334
- **API**: ‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω, –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –ø—É—Å—Ç—ã (–Ω–æ—Ä–º–∞–ª—å–Ω–æ)

### 7. Celery Beat (Docker)
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä**: advakod_celery_beat
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è Running, –Ω–æ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ —Å mount namespace (—Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### 8. –°–µ—Ç–µ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **UFW –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è PostgreSQL**: ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è –≤—Å–µ—Ö Docker —Å–µ—Ç–µ–π
- **–ü–æ—Ä—Ç—ã**: 
  - 80 (HTTP) ‚úÖ
  - 443 (HTTPS) ‚úÖ
  - 5432 (PostgreSQL) ‚úÖ
  - 8000 (Backend) ‚úÖ
  - 3001 (Frontend) ‚úÖ

### 9. –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- **–î–∏—Å–∫**: 117GB —Å–≤–æ–±–æ–¥–Ω–æ (67% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ) ‚úÖ
- **–ü–∞–º—è—Ç—å**: 31GB –¥–æ—Å—Ç—É–ø–Ω–æ –∏–∑ 39GB ‚úÖ
- **CPU**: –ù–æ—Ä–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞

## ‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. Backend Healthcheck
- **–ü—Ä–æ–±–ª–µ–º–∞**: Healthcheck –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å "unhealthy"
- **–ü—Ä–∏—á–∏–Ω–∞**: Healthcheck –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π endpoint (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404)
- **–í–ª–∏—è–Ω–∏–µ**: –ù–µ—Ç, API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –û–±–Ω–æ–≤–∏—Ç—å healthcheck –≤ docker-compose.prod.yml –Ω–∞ `/api/v1/health`

### 2. Celery Beat –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- **–ü—Ä–æ–±–ª–µ–º–∞**: –û—à–∏–±–∫–∞ mount namespace –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥
- **–ü—Ä–∏—á–∏–Ω–∞**: –°—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, —Å–æ–∑–¥–∞–Ω–Ω—ã–π 6 –¥–Ω–µ–π –Ω–∞–∑–∞–¥
- **–í–ª–∏—è–Ω–∏–µ**: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏: `docker-compose up -d celery_beat`

### 3. Nginx 404 –æ—à–∏–±–∫–∏
- **–ü—Ä–æ–±–ª–µ–º–∞**: –û—à–∏–±–∫–∏ 404 –¥–ª—è `/favicon.ico` –∏ `/404.html`
- **–ü—Ä–∏—á–∏–Ω–∞**: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã Nginx –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
- **–í–ª–∏—è–Ω–∏–µ**: –ù–µ—Ç, —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É 404 –∏–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å

### 4. –¢–∞–±–ª–∏—Ü–∞ "chats"
- **–ü—Ä–æ–±–ª–µ–º–∞**: –í –ø—Ä–æ–≤–µ—Ä–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã
- **–†–µ–∞–ª—å–Ω–æ—Å—Ç—å**: –¢–∞–±–ª–∏—Ü—ã –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è `chat_messages` –∏ `chat_sessions`
- **–í–ª–∏—è–Ω–∏–µ**: –ù–µ—Ç, —ç—Ç–æ –±—ã–ª–∞ –æ—à–∏–±–∫–∞ –≤ —Å–∫—Ä–∏–ø—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

## ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

1. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –∏–∑ Backend**: ‚úÖ –£—Å–ø–µ—à–Ω–æ
2. **API Health Endpoint**: ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 200 OK
3. **–í–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ HTTPS**: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
4. **SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç**: ‚úÖ –í–∞–ª–∏–¥–µ–Ω
5. **Redis**: ‚úÖ –û—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ PING
6. **Qdrant**: ‚úÖ API –¥–æ—Å—Ç—É–ø–µ–Ω

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**: 3
- **–¢–∞–±–ª–∏—Ü—ã**: 64
- **–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã**:
  - `users`
  - `chat_messages`
  - `chat_sessions`
  - `ab_tests`
  - `audit_logs`
  - –ò –¥—Ä—É–≥–∏–µ...

## üéØ –í—ã–≤–æ–¥—ã

1. ‚úÖ **–ú–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ** - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã, —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç
2. ‚úÖ **PostgreSQL –Ω–∞ —Ö–æ—Å—Ç–µ** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
3. ‚úÖ **Nginx –Ω–∞ —Ö–æ—Å—Ç–µ** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, SSL –Ω–∞—Å—Ç—Ä–æ–µ–Ω
4. ‚úÖ **–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–µ—Ä–≤–∏—Å—ã** - —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ
5. ‚ö†Ô∏è **–ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã** - –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–û–±–Ω–æ–≤–∏—Ç—å healthcheck** –¥–ª—è backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ `docker-compose.prod.yml`:
   ```yaml
   healthcheck:
     test: ["CMD", "curl", "-f", "http://localhost:8000/api/v1/health"]
   ```

2. **–ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å Celery Beat** –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏:
   ```bash
   docker-compose -f docker-compose.prod.yml up -d celery_beat
   ```

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ PostgreSQL –∏ Nginx –Ω–∞ —Ö–æ—Å—Ç–µ

4. **–ë—ç–∫–∞–ø—ã**: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–∫—Ä–∏–ø—Ç—ã –±—ç–∫–∞–ø–∞ —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Ö–æ—Å—Ç–æ–≤–æ–π PostgreSQL

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏. –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

**–°—Ç–∞—Ç—É—Å**: üü¢ Production Ready

